(function (a) { a.fn.jqmTooltip = function (b) { function f(b) { if (b = "all") { b = a(".jqmTooltip") } a(b).fadeOut(d.fadeSpeed) } function e(b) { a(b).fadeIn(d.fadeSpeed) } var c = a(this), d = { arrow: true, fadeSpeed: 200, maxWidth: 280, minSideMargins: 15, position: "autoUnder", offset: 15, text: "title" }; c.parents('div:jqmData(role="page")').bind("tap.jqmTooltip", function (a) { f("all") }); a(window).bind("resize.jqmTooltip", function (a) { f("all") }); return this.each(function () { if (b) { a.extend(d, b) } var g = {}, h = "tooltip-" + Math.floor(Math.random() * 1e3), i, j, k, l, m, n, o, p; i = a('<div class="jqmTooltip">'); if (d.text == "title") { d.text = c.attr("title"); c.attr("title", "") } i.html(d.text).attr("id", h).css("display", "none").append('<a href="#" class="close">×</div>').find(".close").bind("tap", function (a) { a.preventDefault(); f("#" + h) }); if (d.arrow) { i.append('<div class="arrow">'); var q } c.parents('div:jqmData(role="page")').append(i); c.bind("tap.jqmTooltip", function (b) { b.stopPropagation(); if (i.hasClass("active")) { f(i) } else { m = a(b.target); n = m.offset(); o = a(window).height(); p = a(window).width(); j = p - 2 * d.minSideMargins; if (j > d.maxWidth) { j = d.maxWidth } g.width = j; k = n.left + m.width() / 2 - j / 2; if (k + j > p) { g.left = "auto"; g.right = d.minSideMargins; if (d.arrow) { l = i.offset(); q = n.left - (p - d.minSideMargins - j) + m.width() / 2 + "px"; i.find(".arrow").css("left", q) } } else if (k < 0) { g.left = d.minSideMargins; g.right = "auto"; if (d.arrow) { q = n.left - d.minSideMargins + m.width() / 2 + "px"; i.find(".arrow").css("left", q) } } else { g.left = n.left + m.width() / 2 - j / 2; if (d.arrow) { i.find(".arrow").css("left", "50%") } } switch (d.position) { case "over": g.top = "auto"; g.bottom = o - n.top + d.offset + "px"; i.addClass("over").css(g); e(i); break; case "under": g.top = n.top + m.outerHeight() + d.offset + "px"; g.bottom = "auto"; i.addClass("under").css(g); e(i); break; case "autoOver": i.css(g); e(i); if (i.outerHeight() + d.offset > n.top - a(window).scrollTop()) { g.top = n.top + m.outerHeight() + d.offset + "px"; i.addClass("under").removeClass("over").css(g) } else { g.top = n.top - i.outerHeight() - d.offset + "px"; i.addClass("over").removeClass("under").css(g) } break; default: i.css(g); e(i); if (i.outerHeight() + d.offset > a(window).height() - n.top) { g.top = n.top - i.outerHeight() - d.offset + "px"; i.addClass("over").removeClass("under").css(g) } else { g.top = n.top + m.outerHeight() + d.offset + "px"; i.addClass("under").removeClass("over").css(g) } break } } }) }) } })(jQuery); !function (a, b) { function j(a, b) { function c() { } c[e] = this[e]; var d = this, g = new c, h = f(a), j = h ? a : this, k = h ? {} : a, l = function () { if (this.initialize) { this.initialize.apply(this, arguments) } else { b || h && d.apply(this, arguments); j.apply(this, arguments) } }; l.methods = function (a) { i(g, a, d); l[e] = g; return this }; l.methods.call(l, k).prototype.constructor = l; l.extend = arguments.callee; l[e].implement = l.statics = function (a, b) { a = typeof a == "string" ? function () { var c = {}; c[a] = b; return c } () : a; i(this, a, d); return this }; return l } function i(a, b, d) { for (var g in b) { if (b.hasOwnProperty(g)) { a[g] = f(b[g]) && f(d[e][g]) && c.test(b[g]) ? h(g, b[g], d) : b[g] } } } function h(a, b, c) { return function () { var d = this.supr; this.supr = c[e][a]; var f = b.apply(this, arguments); this.supr = d; return f } } function g(a) { return j.call(f(a) ? a : d, a, 1) } var c = /xyz/.test(function () { xyz }) ? /\bsupr\b/ : /.*/, d = function () { }, e = "prototype", f = function (a) { return typeof a === b }; if (typeof module !== "undefined" && module.exports) { module.exports = g } else { var k = a.klass; g.noConflict = function () { a.klass = k; return this }; a.klass = g } } (this, "function"); (function (a) { if (!Function.prototype.bind) { Function.prototype.bind = function (a) { var b = [].slice, c = b.call(arguments, 1), d = this, e = function () { }, f = function () { return d.apply(this instanceof e ? this : a || {}, c.concat(b.call(arguments))) }; e.prototype = d.prototype; f.prototype = new e; return f } } if (typeof a.Code === "undefined") { a.Code = {} } a.Code.Util = { registerNamespace: function () { var b = arguments, c = null, d, e, f, g, h; for (d = 0; d < b.length; d++) { f = b[d]; g = f.split("."); h = g[0]; if (typeof a[h] === "undefined") { a[h] = {} } c = a[h]; for (e = 1; e < g.length; ++e) { c[g[e]] = c[g[e]] || {}; c = c[g[e]] } } }, coalesce: function () { var a; for (a = 0; a < arguments.length; a++) { if (!this.isNothing(arguments[a])) { return arguments[a] } } return null }, extend: function (a, b, c) { var d; if (this.isNothing(c)) { c = true } if (a && b && this.isObject(b)) { for (d in b) { if (this.objectHasProperty(b, d)) { if (c) { a[d] = b[d] } else { if (typeof a[d] === "undefined") { a[d] = b[d] } } } } } }, clone: function (a) { var b = {}; this.extend(b, a); return b }, isObject: function (a) { return a instanceof Object }, isFunction: function (a) { return {}.toString.call(a) === "[object Function]" }, isArray: function (a) { return a instanceof Array }, isLikeArray: function (a) { return typeof a.length === "number" }, isNumber: function (a) { return typeof a === "number" }, isString: function (a) { return typeof a === "string" }, isNothing: function (a) { if (typeof a === "undefined" || a === null) { return true } return false }, swapArrayElements: function (a, b, c) { var d = a[b]; a[b] = a[c]; a[c] = d }, trim: function (a) { return a.replace(/^\s\s*/, "").replace(/\s\s*$/, "") }, toCamelCase: function (a) { return a.replace(/(\-[a-z])/g, function (a) { return a.toUpperCase().replace("-", "") }) }, toDashedCase: function (a) { return a.replace(/([A-Z])/g, function (a) { return "-" + a.toLowerCase() }) }, objectHasProperty: function (a, b) { if (a.hasOwnProperty) { return a.hasOwnProperty(b) } else { return "undefined" !== typeof a[b] } } } })(window); (function (a, b) { b.Browser = { ua: null, version: null, safari: null, webkit: null, opera: null, msie: null, chrome: null, mozilla: null, android: null, blackberry: null, iPad: null, iPhone: null, iPod: null, iOS: null, is3dSupported: null, isCSSTransformSupported: null, isTouchSupported: null, isGestureSupported: null, _detect: function () { this.ua = a.navigator.userAgent; this.version = this.ua.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/) || []; this.safari = /Safari/gi.test(a.navigator.appVersion); this.webkit = /webkit/i.test(this.ua); this.opera = /opera/i.test(this.ua); this.msie = /msie/i.test(this.ua) && !this.opera; this.chrome = /Chrome/i.test(this.ua); this.mozilla = /mozilla/i.test(this.ua) && !/(compatible|webkit)/.test(this.ua); this.android = /android/i.test(this.ua); this.blackberry = /blackberry/i.test(this.ua); this.iOS = /iphone|ipod|ipad/gi.test(a.navigator.platform); this.iPad = /ipad/gi.test(a.navigator.platform); this.iPhone = /iphone/gi.test(a.navigator.platform); this.iPod = /ipod/gi.test(a.navigator.platform); var c = document.createElement("div"); this.is3dSupported = !b.isNothing(c.style.WebkitPerspective); this.isCSSTransformSupported = !b.isNothing(c.style.WebkitTransform) || !b.isNothing(c.style.MozTransform) || !b.isNothing(c.style.transformProperty); this.isTouchSupported = this.isEventSupported("touchstart"); this.isGestureSupported = this.isEventSupported("gesturestart") }, _eventTagNames: { select: "input", change: "input", submit: "form", reset: "form", error: "img", load: "img", abort: "img" }, isEventSupported: function (a) { var c = document.createElement(this._eventTagNames[a] || "div"), d; a = "on" + a; d = b.objectHasProperty(c, a); if (!d) { c.setAttribute(a, "return;"); d = typeof c[a] === "function" } c = null; return d } }; b.Browser._detect() })(window, window.Code.Util); (function (a, b, c) { c.extend(c, { Events: { add: function (a, c, d) { b(a).bind(c, d) }, remove: function (a, c, d) { b(a).unbind(c, d) }, fire: function (a, c) { var d, e = Array.prototype.slice.call(arguments).splice(2); if (typeof c === "string") { d = { type: c} } else { d = c } b(a).trigger(b.Event(d.type, d), e) }, getMousePosition: function (a) { var b = { x: a.pageX, y: a.pageY }; return b }, getTouchEvent: function (a) { return a.originalEvent }, getWheelDelta: function (a) { var b = 0; if (!c.isNothing(a.wheelDelta)) { b = a.wheelDelta / 120 } else if (!c.isNothing(a.detail)) { b = -a.detail / 3 } return b }, domReady: function (a) { b(document).ready(a) } } }) })(window, window.jQuery, window.Code.Util); (function (a, b, c) { c.extend(c, { DOM: { setData: function (a, b, d) { c.DOM.setAttribute(a, "data-" + b, d) }, getData: function (a, b, d) { return c.DOM.getAttribute(a, "data-" + b, d) }, removeData: function (a, b) { c.DOM.removeAttribute(a, "data-" + b) }, isChildOf: function (a, b) { if (b === a) { return false } while (a && a !== b) { a = a.parentNode } return a === b }, find: function (d, e) { if (c.isNothing(e)) { e = a.document } var f = b(d, e), g = [], h; for (h = 0; h < f.length; h++) { g.push(f[h]) } return g }, createElement: function (a, c, d) { var e = b("<" + a + "></" + a + ">"); e.attr(c); e.append(d); return e[0] }, appendChild: function (a, c) { b(c).append(a) }, insertBefore: function (a, c, d) { b(a).insertBefore(c) }, appendText: function (a, c) { b(c).text(a) }, appendToBody: function (a) { b("body").append(a) }, removeChild: function (a, c) { b(a).empty().remove() }, removeChildren: function (a) { b(a).empty() }, hasAttribute: function (a, d) { return !c.isNothing(b(a).attr(d)) }, getAttribute: function (a, d, e) { var f = b(a).attr(d); if (c.isNothing(f) && !c.isNothing(e)) { f = e } return f }, setAttribute: function (a, c, d) { b(a).attr(c, d) }, removeAttribute: function (a, c) { b(a).removeAttr(c) }, addClass: function (a, c) { b(a).addClass(c) }, removeClass: function (a, c) { b(a).removeClass(c) }, hasClass: function (a, c) { b(a).hasClass(c) }, setStyle: function (a, d, e) { var f; if (c.isObject(d)) { for (f in d) { if (c.objectHasProperty(d, f)) { if (f === "width") { c.DOM.width(a, d[f]) } else if (f === "height") { c.DOM.height(a, d[f]) } else { b(a).css(f, d[f]); a.style[f] = d[f] } } } } else { b(a).css(d, e) } }, getStyle: function (a, c) { return b(a).css(c) }, hide: function (a) { b(a).hide() }, show: function (a) { b(a).show() }, width: function (a, d) { if (!c.isNothing(d)) { b(a).width(d) } return b(a).width() }, outerWidth: function (a) { return b(a).outerWidth() }, height: function (a, d) { if (!c.isNothing(d)) { b(a).height(d) } return b(a).height() }, outerHeight: function (a) { return b(a).outerHeight() }, documentWidth: function () { return b(document.documentElement).width() }, documentHeight: function () { return b(document.documentElement).height() }, documentOuterWidth: function () { return c.DOM.width(document.documentElement) }, documentOuterHeight: function () { return c.DOM.outerHeight(document.documentElement) }, bodyWidth: function () { return b(document.body).width() }, bodyHeight: function () { return b(document.body).height() }, bodyOuterWidth: function () { return c.DOM.outerWidth(document.body) }, bodyOuterHeight: function () { return c.DOM.outerHeight(document.body) }, windowWidth: function () { if (!a.innerWidth) { return b(a).width() } return a.innerWidth }, windowHeight: function () { if (!a.innerHeight) { return b(a).height() } return a.innerHeight }, windowScrollLeft: function () { if (!a.pageXOffset) { return b(a).scrollLeft() } return a.pageXOffset }, windowScrollTop: function () { if (!a.pageYOffset) { return b(a).scrollTop() } return a.pageYOffset } } }) })(window, window.jQuery, window.Code.Util); (function (a, b) { b.extend(b, { Animation: { _applyTransitionDelay: 50, _transitionEndLabel: a.document.documentElement.style.webkitTransition !== undefined ? "webkitTransitionEnd" : "transitionend", _transitionEndHandler: null, _transitionPrefix: a.document.documentElement.style.webkitTransition !== undefined ? "webkitTransition" : a.document.documentElement.style.MozTransition !== undefined ? "MozTransition" : "transition", _transformLabel: a.document.documentElement.style.webkitTransform !== undefined ? "webkitTransform" : a.document.documentElement.style.MozTransition !== undefined ? "MozTransform" : "transform", _getTransitionEndHandler: function () { if (b.isNothing(this._transitionEndHandler)) { this._transitionEndHandler = this._onTransitionEnd.bind(this) } return this._transitionEndHandler }, stop: function (c) { if (b.Browser.isCSSTransformSupported) { var d = c.style[this._transitionPrefix + "Property"], e = d !== "" ? "ccl" + d + "callback" : "cclallcallback", f = {}; b.Events.remove(c, this._transitionEndLabel, this._getTransitionEndHandler()); if (b.isNothing(c.callbackLabel)) { delete c.callbackLabel } f[this._transitionPrefix + "Property"] = ""; f[this._transitionPrefix + "Duration"] = ""; f[this._transitionPrefix + "TimingFunction"] = ""; f[this._transitionPrefix + "Delay"] = ""; f[this._transformLabel] = ""; b.DOM.setStyle(c, f) } else if (!b.isNothing(a.jQuery)) { a.jQuery(c).stop(true, true) } }, fadeIn: function (c, d, e, f) { if (d <= 0) { b.DOM.setStyle(c, "opacity", 1); if (!b.isNothing(e)) { e(c); return } } var g = b.DOM.getStyle(c, "opacity"); if (g >= 1) { b.DOM.setStyle(c, "opacity", 0) } if (b.Browser.isCSSTransformSupported) { this._applyTransition(c, "opacity", 1, d, e, f) } else if (!b.isNothing(a.jQuery)) { a.jQuery(c).fadeTo(d, 1, e) } }, fadeOut: function (c, d, e, f) { if (d <= 0) { b.DOM.setStyle(c, "opacity", 0); if (!b.isNothing(e)) { e(c); return } } if (b.Browser.isCSSTransformSupported) { this._applyTransition(c, "opacity", 0, d, e, f) } else { a.jQuery(c).fadeTo(d, 0, e) } }, slideBy: function (c, d, e, f, g, h) { var i = {}; d = b.coalesce(d, 0); e = b.coalesce(e, 0); h = b.coalesce(h, "ease-out"); i[this._transitionPrefix + "Property"] = "all"; i[this._transitionPrefix + "Delay"] = "0"; if (f === 0) { i[this._transitionPrefix + "Duration"] = ""; i[this._transitionPrefix + "TimingFunction"] = "" } else { i[this._transitionPrefix + "Duration"] = f + "ms"; i[this._transitionPrefix + "TimingFunction"] = b.coalesce(h, "ease-out"); b.Events.add(c, this._transitionEndLabel, this._getTransitionEndHandler()) } i[this._transformLabel] = b.Browser.is3dSupported ? "translate3d(" + d + "px, " + e + "px, 0px)" : "translate(" + d + "px, " + e + "px)"; if (!b.isNothing(g)) { c.cclallcallback = g } b.DOM.setStyle(c, i); if (f === 0) { a.setTimeout(function () { this._leaveTransforms(c) } .bind(this), this._applyTransitionDelay) } }, resetTranslate: function (a) { var c = {}; c[this._transformLabel] = c[this._transformLabel] = b.Browser.is3dSupported ? "translate3d(0px, 0px, 0px)" : "translate(0px, 0px)"; b.DOM.setStyle(a, c) }, _applyTransition: function (c, d, e, f, g, h) { var i = {}; h = b.coalesce(h, "ease-in"); i[this._transitionPrefix + "Property"] = d; i[this._transitionPrefix + "Duration"] = f + "ms"; i[this._transitionPrefix + "TimingFunction"] = h; i[this._transitionPrefix + "Delay"] = "0"; b.Events.add(c, this._transitionEndLabel, this._getTransitionEndHandler()); b.DOM.setStyle(c, i); if (!b.isNothing(g)) { c["ccl" + d + "callback"] = g } a.setTimeout(function () { b.DOM.setStyle(c, d, e) }, this._applyTransitionDelay) }, _onTransitionEnd: function (a) { b.Events.remove(a.currentTarget, this._transitionEndLabel, this._getTransitionEndHandler()); this._leaveTransforms(a.currentTarget) }, _leaveTransforms: function (c) { var d = c.style[this._transitionPrefix + "Property"], e = d !== "" ? "ccl" + d + "callback" : "cclallcallback", f, g = b.coalesce(c.style.webkitTransform, c.style.MozTransform, c.style.transform), h, i, j = a.parseInt(b.DOM.getStyle(c, "left"), 0), k = a.parseInt(b.DOM.getStyle(c, "top"), 0), l, m, n = {}; if (g !== "") { if (b.Browser.is3dSupported) { h = g.match(/translate3d\((.*?)\)/) } else { h = g.match(/translate\((.*?)\)/) } if (!b.isNothing(h)) { i = h[1].split(", "); l = a.parseInt(i[0], 0); m = a.parseInt(i[1], 0) } } n[this._transitionPrefix + "Property"] = ""; n[this._transitionPrefix + "Duration"] = ""; n[this._transitionPrefix + "TimingFunction"] = ""; n[this._transitionPrefix + "Delay"] = ""; b.DOM.setStyle(c, n); a.setTimeout(function () { if (!b.isNothing(i)) { n = {}; n[this._transformLabel] = ""; n.left = j + l + "px"; n.top = k + m + "px"; b.DOM.setStyle(c, n) } if (!b.isNothing(c[e])) { f = c[e]; delete c[e]; f(c) } } .bind(this), this._applyTransitionDelay) } } }) })(window, window.Code.Util); (function (a, b, c) { c.registerNamespace("Code.PhotoSwipe.TouchElement"); var d = a.Code.PhotoSwipe; d.TouchElement.EventTypes = { onTouch: "CodePhotoSwipeTouchElementOnTouch" }; d.TouchElement.ActionTypes = { touchStart: "touchStart", touchMove: "touchMove", touchEnd: "touchEnd", tap: "tap", doubleTap: "doubleTap", swipeLeft: "swipeLeft", swipeRight: "swipeRight", swipeUp: "swipeUp", swipeDown: "swipeDown", gestureStart: "gestureStart", gestureChange: "gestureChange", gestureEnd: "gestureEnd"} })(window, window.klass, window.Code.Util); (function (a, b, c) { c.registerNamespace("Code.PhotoSwipe.TouchElement"); var d = a.Code.PhotoSwipe; d.TouchElement.TouchElementClass = b({ el: null, touchSettings: null, touchStartPoint: null, touchEndPoint: null, touchStartTime: null, doubleTapTimeout: null, touchStartHandler: null, touchMoveHandler: null, touchEndHandler: null, mouseDownHandler: null, mouseMoveHandler: null, mouseUpHandler: null, mouseOutHandler: null, gestureStartHandler: null, gestureChangeHandler: null, gestureEndHandler: null, initialize: function (a) { this.touchSettings = { swipeThreshold: 50, swipeTimeThreshold: 250, doubleTapSpeed: 250 }; c.extend(this.touchSettings, a); this.touchStartPoint = { x: 0, y: 0 }; this.touchEndPoint = { x: 0, y: 0} }, addEventHandlers: function () { if (c.isNothing(this.touchStartHandler)) { this.touchStartHandler = this.onTouchStart.bind(this); this.touchMoveHandler = this.onTouchMove.bind(this); this.touchEndHandler = this.onTouchEnd.bind(this); this.mouseDownHandler = this.onMouseDown.bind(this); this.mouseMoveHandler = this.onMouseMove.bind(this); this.mouseUpHandler = this.onMouseUp.bind(this); this.mouseOutHandler = this.onMouseOut.bind(this); this.gestureStartHandler = this.onGestureStart.bind(this); this.gestureChangeHandler = this.onGestureChange.bind(this); this.gestureEndHandler = this.onGestureEnd.bind(this) } c.Events.add(this.el, "touchstart", this.touchStartHandler); c.Events.add(this.el, "touchmove", this.touchMoveHandler); c.Events.add(this.el, "touchend", this.touchEndHandler); c.Events.add(this.el, "mousedown", this.mouseDownHandler); if (c.Browser.isGestureSupported) { c.Events.add(this.el, "gesturestart", this.gestureStartHandler); c.Events.add(this.el, "gesturechange", this.gestureChangeHandler); c.Events.add(this.el, "gestureend", this.gestureEndHandler) } }, removeEventHandlers: function () { c.Events.remove(this.el, "touchstart", this.touchStartHandler); c.Events.remove(this.el, "touchmove", this.touchMoveHandler); c.Events.remove(this.el, "touchend", this.touchEndHandler); c.Events.remove(this.el, "mousedown", this.mouseDownHandler); if (c.Browser.isGestureSupported) { c.Events.remove(this.el, "gesturestart", this.gestureStartHandler); c.Events.remove(this.el, "gesturechange", this.gestureChangeHandler); c.Events.remove(this.el, "gestureend", this.gestureEndHandler) } }, getTouchPoint: function (a) { return { x: a[0].pageX, y: a[0].pageY} }, fireTouchEvent: function () { var b, e = 0, f = 0, g = 0, h, i, j; e = this.touchEndPoint.x - this.touchStartPoint.x; f = this.touchEndPoint.y - this.touchStartPoint.y; g = Math.sqrt(e * e + f * f); i = new Date; j = i - this.touchStartTime; if (j <= this.touchSettings.swipeTimeThreshold) { if (a.Math.abs(e) >= this.touchSettings.swipeThreshold) { c.Events.fire(this, { type: d.TouchElement.EventTypes.onTouch, target: this, point: this.touchEndPoint, action: e < 0 ? d.TouchElement.ActionTypes.swipeLeft : d.TouchElement.ActionTypes.swipeRight }); return } if (a.Math.abs(f) >= this.touchSettings.swipeThreshold) { c.Events.fire(this, { type: d.TouchElement.EventTypes.onTouch, target: this, point: this.touchEndPoint, action: f < 0 ? d.TouchElement.ActionTypes.swipeUp : d.TouchElement.ActionTypes.swipeDown }); return } } if (g > 1) { c.Events.fire(this, { type: d.TouchElement.EventTypes.onTouch, target: this, action: d.TouchElement.ActionTypes.touchEnd, point: this.touchEndPoint }); return } if (c.isNothing(this.doubleTapTimeout)) { h = this; this.doubleTapTimeout = a.setTimeout(function () { h.doubleTapTimeout = null; c.Events.fire(h, { type: d.TouchElement.EventTypes.onTouch, target: h, point: this.touchEndPoint, action: d.TouchElement.ActionTypes.tap }) }, this.touchSettings.doubleTapSpeed); return } else { a.clearTimeout(this.doubleTapTimeout); this.doubleTapTimeout = null; c.Events.fire(this, { type: d.TouchElement.EventTypes.onTouch, target: this, point: this.touchEndPoint, action: d.TouchElement.ActionTypes.doubleTap }) } }, onTouchStart: function (a) { a.preventDefault(); c.Events.remove(this.el, "mousedown", this.mouseDownHandler); var b = c.Events.getTouchEvent(a), e = b.touches; if (e.length > 1) { this.isGesture = true; return } this.touchStartTime = new Date; this.isGesture = false; this.touchStartPoint = this.getTouchPoint(e); c.Events.fire(this, { type: d.TouchElement.EventTypes.onTouch, target: this, action: d.TouchElement.ActionTypes.touchStart, point: this.touchStartPoint }) }, onTouchMove: function (a) { a.preventDefault(); if (this.isGesture) { return } var b = c.Events.getTouchEvent(a), e = b.touches; c.Events.fire(this, { type: d.TouchElement.EventTypes.onTouch, target: this, action: d.TouchElement.ActionTypes.touchMove, point: this.getTouchPoint(e) }) }, onTouchEnd: function (a) { if (this.isGesture) { return } a.preventDefault(); var b = c.Events.getTouchEvent(a), d = !c.isNothing(b.changedTouches) ? b.changedTouches : b.touches; this.touchEndPoint = this.getTouchPoint(d); this.fireTouchEvent() }, onMouseDown: function (a) { a.preventDefault(); c.Events.remove(this.el, "touchstart", this.mouseDownHandler); c.Events.remove(this.el, "touchmove", this.touchMoveHandler); c.Events.remove(this.el, "touchend", this.touchEndHandler); c.Events.add(this.el, "mousemove", this.mouseMoveHandler); c.Events.add(this.el, "mouseup", this.mouseUpHandler); c.Events.add(this.el, "mouseout", this.mouseOutHandler); this.touchStartTime = new Date; this.isGesture = false; this.touchStartPoint = c.Events.getMousePosition(a); c.Events.fire(this, { type: d.TouchElement.EventTypes.onTouch, target: this, action: d.TouchElement.ActionTypes.touchStart, point: this.touchStartPoint }) }, onMouseMove: function (a) { a.preventDefault(); c.Events.fire(this, { type: d.TouchElement.EventTypes.onTouch, target: this, action: d.TouchElement.ActionTypes.touchMove, point: c.Events.getMousePosition(a) }) }, onMouseUp: function (a) { a.preventDefault(); c.Events.remove(this.el, "mousemove", this.mouseMoveHandler); c.Events.remove(this.el, "mouseup", this.mouseUpHandler); c.Events.remove(this.el, "mouseout", this.mouseOutHandler); this.touchEndPoint = c.Events.getMousePosition(a); this.fireTouchEvent() }, onMouseOut: function (a) { a.preventDefault(); c.Events.remove(this.el, "mousemove", this.mouseMoveHandler); c.Events.remove(this.el, "mouseup", this.mouseUpHandler); c.Events.remove(this.el, "mouseout", this.mouseOutHandler); this.touchEndPoint = c.Events.getMousePosition(a); this.fireTouchEvent() }, onGestureStart: function (a) { a.preventDefault(); var b = c.Events.getTouchEvent(a); c.Events.fire(this, { type: d.TouchElement.EventTypes.onTouch, target: this, action: d.TouchElement.ActionTypes.gestureStart, scale: b.scale, rotation: b.rotation }) }, onGestureChange: function (a) { a.preventDefault(); var b = c.Events.getTouchEvent(a); c.Events.fire(this, { type: d.TouchElement.EventTypes.onTouch, target: this, action: d.TouchElement.ActionTypes.gestureChange, scale: b.scale, rotation: b.rotation }) }, onGestureEnd: function (a) { a.preventDefault(); var b = c.Events.getTouchEvent(a); c.Events.fire(this, { type: d.TouchElement.EventTypes.onTouch, target: this, action: d.TouchElement.ActionTypes.gestureEnd, scale: b.scale, rotation: b.rotation }) } }) })(window, window.klass, window.Code.Util); (function (a, b, c) { c.registerNamespace("Code.PhotoSwipe.Image"); var d = a.Code.PhotoSwipe; d.Image.EventTypes = { onLoad: "onLoad"} })(window, window.klass, window.Code.Util); (function (a, b, c) { c.registerNamespace("Code.PhotoSwipe.Image"); var d = a.Code.PhotoSwipe; d.Image.ImageClass = b({ refObj: null, imageEl: null, src: null, caption: null, metaData: null, naturalWidth: null, naturalHeight: null, isLandscape: null, isLoading: null, imageLoadHandler: null, dispose: function () { var a, b; this.shrinkImage(); for (a in this) { if (c.objectHasProperty(this, a)) { this[a] = null } } }, initialize: function (b, c, d, e) { this.refObj = b; this.src = c; this.caption = d; this.metaData = e; this.naturalWidth = 0; this.naturalHeight = 0; this.isLandscape = false; this.isLoading = false; this.imageEl = new a.Image; this.imageLoadHandler = this.onImageLoad.bind(this) }, load: function () { if (this.imageEl.src.indexOf(this.src) > -1) { c.Events.fire(this, { type: d.Image.EventTypes.onLoad, target: this }); return } this.imageEl.isLoading = true; this.imageEl.onload = this.imageLoadHandler; this.imageEl.src = this.src }, shrinkImage: function () { if (c.isNothing(this.imageEl)) { return } if (this.imageEl.src.indexOf(this.src) > -1) { this.imageEl.src = "data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="; if (!c.isNothing(this.imageEl.parentNode)) { c.DOM.removeChild(this.imageEl, this.imageEl.parentNode) } } }, onImageLoad: function (a) { this.imageEl.onload = null; this.imageEl.naturalWidth = c.coalesce(this.imageEl.naturalWidth, this.imageEl.width); this.imageEl.naturalHeight = c.coalesce(this.imageEl.naturalHeight, this.imageEl.height); this.imageEl.isLandscape = this.imageEl.naturalWidth > this.imageEl.naturalHeight; this.imageEl.isLoading = false; c.Events.fire(this, { type: d.Image.EventTypes.onLoad, target: this }) } }) })(window, window.klass, window.Code.Util); (function (a, b, c) { c.registerNamespace("Code.PhotoSwipe.Cache"); var d = a.Code.PhotoSwipe; d.Cache.Mode = { normal: "normal", aggressive: "aggressive" }; d.Cache.Functions = { getImageSource: function (a) { return a.href }, getImageCaption: function (a) { if (a.nodeName === "IMG") { return c.DOM.getAttribute(a, "alt") } var b, d; for (b = 0; b < a.childNodes.length; b++) { d = a.childNodes[b]; if (a.childNodes[b].nodeName === "IMG") { return c.DOM.getAttribute(d, "alt") } } }, getImageMetaData: function (a) { return {} } } })(window, window.klass, window.Code.Util); (function (a, b, c, d) { c.registerNamespace("Code.PhotoSwipe.Cache"); var e = a.Code.PhotoSwipe; e.Cache.CacheClass = b({ images: null, settings: null, dispose: function () { var a, b; if (!c.isNothing(this.images)) { for (b = 0; b < this.images.length; b++) { this.images[b].dispose() } this.images.length = 0 } for (a in this) { if (c.objectHasProperty(this, a)) { this[a] = null } } }, initialize: function (a, b) { var c, e, f, g, h, i; this.settings = b; this.images = []; for (c = 0; c < a.length; c++) { f = a[c]; g = this.settings.getImageSource(f); h = this.settings.getImageCaption(f); i = this.settings.getImageMetaData(f); this.images.push(new d.ImageClass(f, g, h, i)) } }, getImages: function (a) { var b, d = [], f; for (b = 0; b < a.length; b++) { f = this.images[a[b]]; if (this.settings.cacheMode === e.Cache.Mode.aggressive) { f.cacheDoNotShrink = true } d.push(f) } if (this.settings.cacheMode === e.Cache.Mode.aggressive) { for (b = 0; b < this.images.length; b++) { f = this.images[b]; if (!c.objectHasProperty(f, "cacheDoNotShrink")) { f.shrinkImage() } else { delete f.cacheDoNotShrink } } } return d } }) })(window, window.klass, window.Code.Util, window.Code.PhotoSwipe.Image); (function (a, b, c) { c.registerNamespace("Code.PhotoSwipe.DocumentOverlay"); var d = a.Code.PhotoSwipe; d.DocumentOverlay.CssClasses = { documentOverlay: "ps-document-overlay"} })(window, window.klass, window.Code.Util); (function (a, b, c) { c.registerNamespace("Code.PhotoSwipe.DocumentOverlay"); var d = a.Code.PhotoSwipe; d.DocumentOverlay.DocumentOverlayClass = b({ el: null, settings: null, initialBodyHeight: null, dispose: function () { var a; c.Animation.stop(this.el); c.DOM.removeChild(this.el, this.el.parentNode); for (a in this) { if (c.objectHasProperty(this, a)) { this[a] = null } } }, initialize: function (a) { this.settings = a; this.el = c.DOM.createElement("div", { "class": d.DocumentOverlay.CssClasses.documentOverlay }, ""); c.DOM.setStyle(this.el, { display: "block", position: "absolute", left: 0, top: 0, zIndex: this.settings.zIndex }); c.DOM.hide(this.el); c.DOM.appendToBody(this.el); c.Animation.resetTranslate(this.el); this.initialBodyHeight = c.DOM.bodyOuterHeight() }, resetPosition: function () { var a = c.DOM.windowWidth(), b = c.DOM.bodyOuterHeight() * 2; if (b < 1) { b = this.initialBodyHeight } if (c.DOM.windowHeight() > b) { b = c.DOM.windowHeight() } c.DOM.setStyle(this.el, { width: a, height: b, top: this.settings.jQueryMobile ? c.DOM.windowScrollTop() + "px" : "0px" }) }, fadeIn: function (a, b) { this.resetPosition(); c.DOM.setStyle(this.el, "opacity", 0); c.DOM.show(this.el); c.Animation.fadeIn(this.el, a, b) } }) })(window, window.klass, window.Code.Util); (function (a, b, c) { c.registerNamespace("Code.PhotoSwipe.Carousel"); var d = a.Code.PhotoSwipe; d.Carousel.EventTypes = { onSlideByEnd: "PhotoSwipeCarouselOnSlideByEnd", onSlideshowStart: "PhotoSwipeCarouselOnSlideshowStart", onSlideshowStop: "PhotoSwipeCarouselOnSlideshowStop" }; d.Carousel.CssClasses = { carousel: "ps-carousel", content: "ps-carousel-content", item: "ps-carousel-item", itemLoading: "ps-carousel-item-loading" }; d.Carousel.SlideByAction = { previous: "previous", current: "current", next: "next"} })(window, window.klass, window.Code.Util); (function (a, b, c) { c.registerNamespace("Code.PhotoSwipe.Carousel"); var d = a.Code.PhotoSwipe; d.Carousel.CarouselClass = b({ el: null, contentEl: null, settings: null, cache: null, slideByEndHandler: null, currentCacheIndex: null, isSliding: null, isSlideshowActive: null, lastSlideByAction: null, touchStartPoint: null, touchStartPosition: null, imageLoadHandler: null, slideshowTimeout: null, dispose: function () { var a; this.stopSlideshow(); c.Animation.stop(this.el); c.DOM.removeChild(this.el, this.el.parentNode); for (a in this) { if (c.objectHasProperty(this, a)) { this[a] = null } } }, initialize: function (a, b) { var e, f, g; this.cache = a; this.settings = b; this.slideByEndHandler = this.onSlideByEnd.bind(this); this.imageLoadHandler = this.onImageLoad.bind(this); this.currentCacheIndex = 0; this.isSliding = false; this.isSlideshowActive = false; if (this.cache.images.length < 3) { this.settings.loop = false } this.el = c.DOM.createElement("div", { "class": d.Carousel.CssClasses.carousel }, ""); c.DOM.setStyle(this.el, { display: "block", position: "absolute", left: 0, top: 0, overflow: "hidden", zIndex: this.settings.zIndex }); c.DOM.hide(this.el); this.contentEl = c.DOM.createElement("div", { "class": d.Carousel.CssClasses.content }, ""); c.DOM.setStyle(this.contentEl, { display: "block", position: "absolute", left: 0, top: 0 }); c.DOM.appendChild(this.contentEl, this.el); f = a.images.length < 3 ? a.images.length : 3; for (e = 0; e < f; e++) { g = c.DOM.createElement("div", { "class": d.Carousel.CssClasses.item + " " + d.Carousel.CssClasses.item + "-" + e }, ""); c.DOM.setAttribute(g, "style", "float: left;"); c.DOM.setStyle(g, { display: "block", position: "relative", left: 0, top: 0, overflow: "hidden" }); if (this.settings.margin > 0) { c.DOM.setStyle(g, { marginRight: this.settings.margin + "px" }) } c.DOM.appendChild(g, this.contentEl) } c.DOM.appendToBody(this.el) }, resetPosition: function () { var a = c.DOM.windowWidth(), b = c.DOM.windowHeight(), e = this.settings.margin > 0 ? a + this.settings.margin : a, f = c.DOM.find("." + d.Carousel.CssClasses.item, this.contentEl), g = e * f.length, h, i, j; c.DOM.setStyle(this.el, { top: c.DOM.windowScrollTop() + "px", width: a, height: b }); c.DOM.setStyle(this.contentEl, { width: g, height: b }); for (h = 0; h < f.length; h++) { i = f[h]; c.DOM.setStyle(i, { width: a, height: b }); j = c.DOM.find("img", i)[0]; if (!c.isNothing(j)) { this.resetImagePosition(j) } } this.setContentLeftPosition() }, resetImagePosition: function (a) { if (c.isNothing(a)) { return } var b = c.DOM.getAttribute(a, "src"), d, e, f, g, h, i = c.DOM.width(this.el), j = c.DOM.height(this.el); if (this.settings.imageScaleMethod === "fitNoUpscale") { e = a.naturalWidth; f = a.naturalHeight; if (e > i) { d = i / e; e = Math.round(e * d); f = Math.round(f * d) } if (f > j) { d = j / f; f = Math.round(f * d); e = Math.round(e * d) } } else { if (a.isLandscape) { d = i / a.naturalWidth } else { d = j / a.naturalHeight } e = Math.round(a.naturalWidth * d); f = Math.round(a.naturalHeight * d); if (this.settings.imageScaleMethod === "zoom") { d = 1; if (f < j) { d = j / f } else if (e < i) { d = i / e } if (d !== 1) { e = Math.round(e * d); f = Math.round(f * d) } } else if (this.settings.imageScaleMethod === "fit") { d = 1; if (e > i) { d = i / e } else if (f > j) { d = j / f } if (d !== 1) { e = Math.round(e * d); f = Math.round(f * d) } } } g = Math.round((j - f) / 2) + "px"; h = Math.round((i - e) / 2) + "px"; c.DOM.setStyle(a, { position: "absolute", width: e, height: f, top: g, left: h, display: "block" }) }, setContentLeftPosition: function () { var a = c.DOM.windowWidth(), b = this.getItemEls(), d = 0; if (this.settings.loop) { d = (a + this.settings.margin) * -1 } else { if (this.currentCacheIndex === this.cache.images.length - 1) { d = (b.length - 1) * (a + this.settings.margin) * -1 } else if (this.currentCacheIndex > 0) { d = (a + this.settings.margin) * -1 } } c.DOM.setStyle(this.contentEl, { left: d + "px" }) }, show: function (a) { this.currentCacheIndex = a; this.resetPosition(); this.setImages(false); c.DOM.show(this.el); c.Animation.resetTranslate(this.contentEl); var b = this.getItemEls(), e; for (e = 0; e < b.length; e++) { c.Animation.resetTranslate(b[e]) } c.Events.fire(this, { type: d.Carousel.EventTypes.onSlideByEnd, target: this, action: d.Carousel.SlideByAction.current, cacheIndex: this.currentCacheIndex }) }, setImages: function (a) { var b, c = this.getItemEls(), d = this.currentCacheIndex + 1, e = this.currentCacheIndex - 1; if (this.settings.loop) { if (d > this.cache.images.length - 1) { d = 0 } if (e < 0) { e = this.cache.images.length - 1 } b = this.cache.getImages([e, this.currentCacheIndex, d]); if (!a) { this.addCacheImageToItemEl(b[1], c[1]) } this.addCacheImageToItemEl(b[2], c[2]); this.addCacheImageToItemEl(b[0], c[0]) } else { if (c.length === 1) { if (!a) { b = this.cache.getImages([this.currentCacheIndex]); this.addCacheImageToItemEl(b[0], c[0]) } } else if (c.length === 2) { if (this.currentCacheIndex === 0) { b = this.cache.getImages([this.currentCacheIndex, this.currentCacheIndex + 1]); if (!a) { this.addCacheImageToItemEl(b[0], c[0]) } this.addCacheImageToItemEl(b[1], c[1]) } else { b = this.cache.getImages([this.currentCacheIndex - 1, this.currentCacheIndex]); if (!a) { this.addCacheImageToItemEl(b[1], c[1]) } this.addCacheImageToItemEl(b[0], c[0]) } } else { if (this.currentCacheIndex === 0) { b = this.cache.getImages([this.currentCacheIndex, this.currentCacheIndex + 1, this.currentCacheIndex + 2]); if (!a) { this.addCacheImageToItemEl(b[0], c[0]) } this.addCacheImageToItemEl(b[1], c[1]); this.addCacheImageToItemEl(b[2], c[2]) } else if (this.currentCacheIndex === this.cache.images.length - 1) { b = this.cache.getImages([this.currentCacheIndex - 2, this.currentCacheIndex - 1, this.currentCacheIndex]); if (!a) { this.addCacheImageToItemEl(b[2], c[2]) } this.addCacheImageToItemEl(b[1], c[1]); this.addCacheImageToItemEl(b[0], c[0]) } else { b = this.cache.getImages([this.currentCacheIndex - 1, this.currentCacheIndex, this.currentCacheIndex + 1]); if (!a) { this.addCacheImageToItemEl(b[1], c[1]) } this.addCacheImageToItemEl(b[2], c[2]); this.addCacheImageToItemEl(b[0], c[0]) } } } }, addCacheImageToItemEl: function (a, b) { c.DOM.addClass(b, d.Carousel.CssClasses.itemLoading); c.DOM.removeChildren(b); c.DOM.setStyle(a.imageEl, { display: "none" }); c.DOM.appendChild(a.imageEl, b); c.Animation.resetTranslate(a.imageEl); c.Events.add(a, d.Image.EventTypes.onLoad, this.imageLoadHandler); a.load() }, slideCarousel: function (b, e, f) { if (this.isSliding) { return } var g = c.DOM.windowWidth() + this.settings.margin, h, i; f = c.coalesce(f, this.settings.slideSpeed); if (a.Math.abs(h) < 1) { return } switch (e) { case d.TouchElement.ActionTypes.swipeLeft: i = g * -1; break; case d.TouchElement.ActionTypes.swipeRight: i = g; break; default: h = b.x - this.touchStartPoint.x; if (a.Math.abs(h) > g / 2) { i = h > 0 ? g : g * -1 } else { i = 0 } break } if (i < 0) { this.lastSlideByAction = d.Carousel.SlideByAction.next } else if (i > 0) { this.lastSlideByAction = d.Carousel.SlideByAction.previous } else { this.lastSlideByAction = d.Carousel.SlideByAction.current } if (!this.settings.loop) { if (this.lastSlideByAction === d.Carousel.SlideByAction.previous && this.currentCacheIndex === 0 || this.lastSlideByAction === d.Carousel.SlideByAction.next && this.currentCacheIndex === this.cache.images.length - 1) { i = 0; this.lastSlideByAction = d.Carousel.SlideByAction.current } } this.isSliding = true; this.doSlideCarousel(i, f) }, moveCarousel: function (a) { if (this.isSliding) { return } if (!this.settings.enableDrag) { return } this.doMoveCarousel(a.x - this.touchStartPoint.x) }, getItemEls: function () { return c.DOM.find("." + d.Carousel.CssClasses.item, this.contentEl) }, previous: function () { this.stopSlideshow(); this.slideCarousel({ x: 0, y: 0 }, d.TouchElement.ActionTypes.swipeRight, this.settings.nextPreviousSlideSpeed) }, next: function () { this.stopSlideshow(); this.slideCarousel({ x: 0, y: 0 }, d.TouchElement.ActionTypes.swipeLeft, this.settings.nextPreviousSlideSpeed) }, slideshowNext: function () { this.slideCarousel({ x: 0, y: 0 }, d.TouchElement.ActionTypes.swipeLeft) }, startSlideshow: function () { this.stopSlideshow(); this.isSlideshowActive = true; this.slideshowTimeout = a.setTimeout(this.slideshowNext.bind(this), this.settings.slideshowDelay); c.Events.fire(this, { type: d.Carousel.EventTypes.onSlideshowStart, target: this }) }, stopSlideshow: function () { if (!c.isNothing(this.slideshowTimeout)) { a.clearTimeout(this.slideshowTimeout); this.slideshowTimeout = null; this.isSlideshowActive = false; c.Events.fire(this, { type: d.Carousel.EventTypes.onSlideshowStop, target: this }) } }, onSlideByEnd: function (a) { if (c.isNothing(this.isSliding)) { return } var b = this.getItemEls(); this.isSliding = false; if (this.lastSlideByAction === d.Carousel.SlideByAction.next) { this.currentCacheIndex = this.currentCacheIndex + 1 } else if (this.lastSlideByAction === d.Carousel.SlideByAction.previous) { this.currentCacheIndex = this.currentCacheIndex - 1 } if (this.settings.loop) { if (this.lastSlideByAction === d.Carousel.SlideByAction.next) { c.DOM.appendChild(b[0], this.contentEl) } else if (this.lastSlideByAction === d.Carousel.SlideByAction.previous) { c.DOM.insertBefore(b[b.length - 1], b[0], this.contentEl) } if (this.currentCacheIndex < 0) { this.currentCacheIndex = this.cache.images.length - 1 } else if (this.currentCacheIndex === this.cache.images.length) { this.currentCacheIndex = 0 } } else { if (this.cache.images.length > 3) { if (this.currentCacheIndex > 1 && this.currentCacheIndex < this.cache.images.length - 2) { if (this.lastSlideByAction === d.Carousel.SlideByAction.next) { c.DOM.appendChild(b[0], this.contentEl) } else if (this.lastSlideByAction === d.Carousel.SlideByAction.previous) { c.DOM.insertBefore(b[b.length - 1], b[0], this.contentEl) } } else if (this.currentCacheIndex === 1) { if (this.lastSlideByAction === d.Carousel.SlideByAction.previous) { c.DOM.insertBefore(b[b.length - 1], b[0], this.contentEl) } } else if (this.currentCacheIndex === this.cache.images.length - 2) { if (this.lastSlideByAction === d.Carousel.SlideByAction.next) { c.DOM.appendChild(b[0], this.contentEl) } } } } if (this.lastSlideByAction !== d.Carousel.SlideByAction.current) { this.setContentLeftPosition(); this.setImages(true) } c.Events.fire(this, { type: d.Carousel.EventTypes.onSlideByEnd, target: this, action: this.lastSlideByAction, cacheIndex: this.currentCacheIndex }); if (this.isSlideshowActive) { if (this.lastSlideByAction !== d.Carousel.SlideByAction.current) { this.startSlideshow() } else { this.stopSlideshow() } } }, onTouch: function (b, e) { this.stopSlideshow(); switch (b) { case d.TouchElement.ActionTypes.touchStart: this.touchStartPoint = e; this.touchStartPosition = { x: a.parseInt(c.DOM.getStyle(this.contentEl, "left"), 0), y: a.parseInt(c.DOM.getStyle(this.contentEl, "top"), 0) }; break; case d.TouchElement.ActionTypes.touchMove: this.moveCarousel(e); break; case d.TouchElement.ActionTypes.touchEnd: case d.TouchElement.ActionTypes.swipeLeft: case d.TouchElement.ActionTypes.swipeRight: this.slideCarousel(e, b); break; case d.TouchElement.ActionTypes.tap: break; case d.TouchElement.ActionTypes.doubleTap: break } }, onImageLoad: function (a) { var b = a.target; if (!c.isNothing(b.imageEl.parentNode)) { c.DOM.removeClass(b.imageEl.parentNode, d.Carousel.CssClasses.itemLoading); c.Events.remove(b, d.Image.EventTypes.onLoad, this.imageLoadHandler); this.resetImagePosition(b.imageEl) } } }) })(window, window.klass, window.Code.Util, window.Code.PhotoSwipe.TouchElement); (function (a, b, c, d) { c.registerNamespace("Code.PhotoSwipe.Carousel"); var e = a.Code.PhotoSwipe; e.Carousel.CarouselClass = e.Carousel.CarouselClass.extend({ getStartingPos: function () { var b = this.touchStartPosition; if (c.isNothing(b)) { b = { x: a.parseInt(c.DOM.getStyle(this.contentEl, "left"), 0), y: a.parseInt(c.DOM.getStyle(this.contentEl, "top"), 0)} } return b }, doMoveCarousel: function (b) { var d; if (c.Browser.isCSSTransformSupported) { d = {}; d[c.Animation._transitionPrefix + "Property"] = "all"; d[c.Animation._transitionPrefix + "Duration"] = ""; d[c.Animation._transitionPrefix + "TimingFunction"] = ""; d[c.Animation._transitionPrefix + "Delay"] = "0"; d[c.Animation._transformLabel] = c.Browser.is3dSupported ? "translate3d(" + b + "px, 0px, 0px)" : "translate(" + b + "px, 0px)"; c.DOM.setStyle(this.contentEl, d) } else if (!c.isNothing(a.jQuery)) { a.jQuery(this.contentEl).stop().css("left", this.getStartingPos().x + b + "px") } }, doSlideCarousel: function (b, d) { var e; if (d <= 0) { this.slideByEndHandler(); return } if (c.Browser.isCSSTransformSupported) { c.Animation.slideBy(this.contentEl, b, 0, d, this.slideByEndHandler, this.settings.slideTimingFunction) } else if (!c.isNothing(a.jQuery)) { e = { left: this.getStartingPos().x + b + "px" }; if (this.settings.animationTimingFunction === "ease-out") { this.settings.animationTimingFunction = "easeOutQuad" } if (c.isNothing(a.jQuery.easing[this.settings.animationTimingFunction])) { this.settings.animationTimingFunction = "linear" } a.jQuery(this.contentEl).animate(e, this.settings.slideSpeed, this.settings.animationTimingFunction, this.slideByEndHandler) } } }) })(window, window.klass, window.Code.Util, window.Code.PhotoSwipe.TouchElement); (function (a, b, c) { c.registerNamespace("Code.PhotoSwipe.Toolbar"); var d = a.Code.PhotoSwipe; d.Toolbar.CssClasses = { toolbar: "ps-toolbar", toolbarContent: "ps-toolbar-content", toolbarTop: "ps-toolbar-top", caption: "ps-caption", captionBottom: "ps-caption-bottom", captionContent: "ps-caption-content", close: "ps-toolbar-close", play: "ps-toolbar-play", previous: "ps-toolbar-previous", previousDisabled: "ps-toolbar-previous-disabled", next: "ps-toolbar-next", nextDisabled: "ps-toolbar-next-disabled" }; d.Toolbar.ToolbarAction = { close: "close", play: "play", next: "next", previous: "previous", none: "none" }; d.Toolbar.EventTypes = { onTap: "PhotoSwipeToolbarOnClick", onBeforeShow: "PhotoSwipeToolbarOnBeforeShow", onShow: "PhotoSwipeToolbarOnShow", onBeforeHide: "PhotoSwipeToolbarOnBeforeHide", onHide: "PhotoSwipeToolbarOnHide" }; d.Toolbar.getToolbar = function () { return '<div class="' + d.Toolbar.CssClasses.close + '"><div class="' + d.Toolbar.CssClasses.toolbarContent + '"></div></div><div class="' + d.Toolbar.CssClasses.play + '"><div class="' + d.Toolbar.CssClasses.toolbarContent + '"></div></div><div class="' + d.Toolbar.CssClasses.previous + '"><div class="' + d.Toolbar.CssClasses.toolbarContent + '"></div></div><div class="' + d.Toolbar.CssClasses.next + '"><div class="' + d.Toolbar.CssClasses.toolbarContent + '"></div></div>' } })(window, window.klass, window.Code.Util); (function (a, b, c) { c.registerNamespace("Code.PhotoSwipe.Toolbar"); var d = a.Code.PhotoSwipe; d.Toolbar.ToolbarClass = b({ toolbarEl: null, closeEl: null, playEl: null, previousEl: null, nextEl: null, captionEl: null, captionContentEl: null, currentCaption: null, settings: null, cache: null, timeout: null, isVisible: null, fadeOutHandler: null, touchStartHandler: null, touchMoveHandler: null, clickHandler: null, dispose: function () { var a; this.clearTimeout(); this.removeEventHandlers(); c.Animation.stop(this.toolbarEl); c.Animation.stop(this.captionEl); c.DOM.removeChild(this.toolbarEl, this.toolbarEl.parentNode); c.DOM.removeChild(this.captionEl, this.captionEl.parentNode); for (a in this) { if (c.objectHasProperty(this, a)) { this[a] = null } } }, initialize: function (a, b) { var e; this.settings = b; this.cache = a; this.isVisible = false; this.fadeOutHandler = this.onFadeOut.bind(this); this.touchStartHandler = this.onTouchStart.bind(this); this.touchMoveHandler = this.onTouchMove.bind(this); this.clickHandler = this.onClick.bind(this); e = d.Toolbar.CssClasses.toolbar; if (this.settings.captionAndToolbarFlipPosition) { e = e + " " + d.Toolbar.CssClasses.toolbarTop } this.toolbarEl = c.DOM.createElement("div", { "class": e }, this.settings.getToolbar()); c.DOM.setStyle(this.toolbarEl, { left: 0, position: "absolute", overflow: "hidden", zIndex: this.settings.zIndex }); c.DOM.appendToBody(this.toolbarEl); c.DOM.hide(this.toolbarEl); this.closeEl = c.DOM.find("." + d.Toolbar.CssClasses.close, this.toolbarEl)[0]; if (this.settings.preventHide && !c.isNothing(this.closeEl)) { c.DOM.hide(this.closeEl) } this.playEl = c.DOM.find("." + d.Toolbar.CssClasses.play, this.toolbarEl)[0]; if (this.settings.preventSlideshow && !c.isNothing(this.playEl)) { c.DOM.hide(this.playEl) } this.nextEl = c.DOM.find("." + d.Toolbar.CssClasses.next, this.toolbarEl)[0]; this.previousEl = c.DOM.find("." + d.Toolbar.CssClasses.previous, this.toolbarEl)[0]; e = d.Toolbar.CssClasses.caption; if (this.settings.captionAndToolbarFlipPosition) { e = e + " " + d.Toolbar.CssClasses.captionBottom } this.captionEl = c.DOM.createElement("div", { "class": e }, ""); c.DOM.setStyle(this.captionEl, { left: 0, position: "absolute", overflow: "hidden", zIndex: this.settings.zIndex }); c.DOM.appendToBody(this.captionEl); c.DOM.hide(this.captionEl); this.captionContentEl = c.DOM.createElement("div", { "class": d.Toolbar.CssClasses.captionContent }, ""); c.DOM.appendChild(this.captionContentEl, this.captionEl); this.addEventHandlers() }, resetPosition: function () { var a, b; if (this.settings.captionAndToolbarFlipPosition) { a = c.DOM.windowScrollTop(); b = c.DOM.windowScrollTop() + c.DOM.windowHeight() - c.DOM.height(this.captionEl) } else { a = c.DOM.windowScrollTop() + c.DOM.windowHeight() - c.DOM.height(this.toolbarEl); b = c.DOM.windowScrollTop() } c.DOM.setStyle(this.toolbarEl, { top: a + "px", width: c.DOM.windowWidth() }); c.DOM.setStyle(this.captionEl, { top: b + "px", width: c.DOM.windowWidth() }) }, toggleVisibility: function (a) { if (this.isVisible) { this.fadeOut() } else { this.show(a) } }, show: function (a) { c.Animation.stop(this.toolbarEl); c.Animation.stop(this.captionEl); this.resetPosition(); this.setToolbarStatus(a); c.Events.fire(this, { type: d.Toolbar.EventTypes.onBeforeShow, target: this }); this.showToolbar(); this.setCaption(a); this.showCaption(); this.isVisible = true; this.setTimeout(); c.Events.fire(this, { type: d.Toolbar.EventTypes.onShow, target: this }) }, setTimeout: function () { if (this.settings.captionAndToolbarAutoHideDelay > 0) { this.clearTimeout(); this.timeout = a.setTimeout(this.fadeOut.bind(this), this.settings.captionAndToolbarAutoHideDelay) } }, clearTimeout: function () { if (!c.isNothing(this.timeout)) { a.clearTimeout(this.timeout); this.timeout = null } }, fadeOut: function () { this.clearTimeout(); c.Events.fire(this, { type: d.Toolbar.EventTypes.onBeforeHide, target: this }); c.Animation.fadeOut(this.toolbarEl, this.settings.fadeOutSpeed); c.Animation.fadeOut(this.captionEl, this.settings.fadeOutSpeed, this.fadeOutHandler); this.isVisible = false }, addEventHandlers: function () { if (c.Browser.isTouchSupported) { if (!c.Browser.blackberry) { c.Events.add(this.toolbarEl, "touchstart", this.touchStartHandler) } c.Events.add(this.toolbarEl, "touchmove", this.touchMoveHandler); c.Events.add(this.captionEl, "touchmove", this.touchMoveHandler) } c.Events.add(this.toolbarEl, "click", this.clickHandler) }, removeEventHandlers: function () { if (c.Browser.isTouchSupported) { if (!c.Browser.blackberry) { c.Events.remove(this.toolbarEl, "touchstart", this.touchStartHandler) } c.Events.remove(this.toolbarEl, "touchmove", this.touchMoveHandler); c.Events.remove(this.captionEl, "touchmove", this.touchMoveHandler) } c.Events.remove(this.toolbarEl, "click", this.clickHandler) }, handleTap: function (a) { this.clearTimeout(); var b; if (a.target === this.nextEl || c.DOM.isChildOf(a.target, this.nextEl)) { b = d.Toolbar.ToolbarAction.next } else if (a.target === this.previousEl || c.DOM.isChildOf(a.target, this.previousEl)) { b = d.Toolbar.ToolbarAction.previous } else if (a.target === this.closeEl || c.DOM.isChildOf(a.target, this.closeEl)) { b = d.Toolbar.ToolbarAction.close } else if (a.target === this.playEl || c.DOM.isChildOf(a.target, this.playEl)) { b = d.Toolbar.ToolbarAction.play } this.setTimeout(); if (c.isNothing(b)) { b = d.Toolbar.ToolbarAction.none } c.Events.fire(this, { type: d.Toolbar.EventTypes.onTap, target: this, action: b, tapTarget: a.target }) }, setCaption: function (a) { c.DOM.removeChildren(this.captionContentEl); this.currentCaption = c.coalesce(this.cache.images[a].caption, " "); if (c.isObject(this.currentCaption)) { c.DOM.appendChild(this.currentCaption, this.captionContentEl) } else { if (this.currentCaption === "") { this.currentCaption = " " } c.DOM.appendText(this.currentCaption, this.captionContentEl) } this.currentCaption = this.currentCaption === " " ? "" : this.currentCaption }, showToolbar: function () { c.DOM.setStyle(this.toolbarEl, { opacity: this.settings.captionAndToolbarOpacity }); c.DOM.show(this.toolbarEl) }, showCaption: function () { if (this.currentCaption === "" || this.captionContentEl.childNodes.length < 1) { if (!this.settings.captionAndToolbarShowEmptyCaptions) { c.DOM.hide(this.captionEl); return } } c.DOM.setStyle(this.captionEl, { opacity: this.settings.captionAndToolbarOpacity }); c.DOM.show(this.captionEl) }, setToolbarStatus: function (a) { if (this.settings.loop) { return } if (a > 0 && a < this.cache.images.length - 1) { c.DOM.removeClass(this.previousEl, d.Toolbar.CssClasses.previousDisabled); c.DOM.removeClass(this.nextEl, d.Toolbar.CssClasses.nextDisabled); return } if (a === 0) { if (!c.isNothing(this.previousEl)) { c.DOM.addClass(this.previousEl, d.Toolbar.CssClasses.previousDisabled) } } if (a === this.cache.images.length - 1) { if (!c.isNothing(this.nextEl)) { c.DOM.addClass(this.nextEl, d.Toolbar.CssClasses.nextDisabled) } } }, onFadeOut: function () { c.DOM.hide(this.toolbarEl); c.DOM.hide(this.captionEl); c.Events.fire(this, { type: d.Toolbar.EventTypes.onHide, target: this }) }, onTouchStart: function (a) { a.preventDefault(); c.Events.remove(this.toolbarEl, "click", this.clickHandler); this.handleTap(a) }, onTouchMove: function (a) { a.preventDefault() }, onClick: function (a) { a.preventDefault(); this.handleTap(a) } }) })(window, window.klass, window.Code.Util); (function (a, b, c) { c.registerNamespace("Code.PhotoSwipe.UILayer"); var d = a.Code.PhotoSwipe; d.UILayer.CssClasses = { uiLayer: "ps-uilayer"} })(window, window.klass, window.Code.Util); (function (a, b, c, d) { c.registerNamespace("Code.PhotoSwipe.UILayer"); var e = a.Code.PhotoSwipe; e.UILayer.UILayerClass = d.TouchElementClass.extend({ el: null, settings: null, dispose: function () { var a; this.removeEventHandlers(); c.DOM.removeChild(this.el, this.el.parentNode); for (a in this) { if (c.objectHasProperty(this, a)) { this[a] = null } } }, initialize: function (a) { this.settings = a; this.supr({ swipeThreshold: this.settings.swipeThreshold, swipeTimeThreshold: this.settings.swipeTimeThreshold, doubleTapSpeed: this.settings.doubleTapSpeed }); this.el = c.DOM.createElement("div", { "class": e.UILayer.CssClasses.uiLayer }, ""); c.DOM.setStyle(this.el, { display: "block", position: "absolute", left: 0, top: 0, overflow: "hidden", zIndex: this.settings.zIndex, opacity: 0 }); c.DOM.hide(this.el); c.DOM.appendToBody(this.el) }, resetPosition: function () { c.DOM.setStyle(this.el, { top: c.DOM.windowScrollTop() + "px", width: c.DOM.windowWidth(), height: c.DOM.windowHeight() }) }, show: function () { this.resetPosition(); c.DOM.show(this.el); this.addEventHandlers() }, addEventHandlers: function () { this.supr() }, removeEventHandlers: function () { this.supr() } }) })(window, window.klass, window.Code.Util, window.Code.PhotoSwipe.TouchElement); (function (a, b, c) { c.registerNamespace("Code.PhotoSwipe.ZoomPanRotate"); var d = a.Code.PhotoSwipe; d.ZoomPanRotate.CssClasses = { zoomPanRotate: "ps-zoom-pan-rotate"} })(window, window.klass, window.Code.Util); (function (a, b, c) { c.registerNamespace("Code.PhotoSwipe.ZoomPanRotate"); var d = a.Code.PhotoSwipe; d.ZoomPanRotate.ZoomPanRotateClass = b({ el: null, settings: null, containerEl: null, imageEl: null, transformSettings: null, panStartingPoint: null, transformEl: null, dispose: function () { var a; c.DOM.removeChild(this.el, this.el.parentNode); for (a in this) { if (c.objectHasProperty(this, a)) { this[a] = null } } }, initialize: function (a, b, e) { this.settings = a; this.imageEl = b.imageEl.cloneNode(false); c.DOM.setStyle(this.imageEl, { zIndex: 1 }); this.transformSettings = { startingScale: 1, scale: 1, startingRotation: 0, rotation: 0, startingTranslateX: 0, startingTranslateY: 0, translateX: 0, translateY: 0 }; this.el = c.DOM.createElement("div", { "class": d.ZoomPanRotate.CssClasses.zoomPanRotate }, ""); c.DOM.setStyle(this.el, { left: 0, top: c.DOM.windowScrollTop() + "px", position: "absolute", width: c.DOM.windowWidth(), height: c.DOM.windowHeight(), zIndex: this.settings.zIndex, display: "block" }); c.DOM.insertBefore(this.el, e.el, document.body); if (c.Browser.iOS) { this.containerEl = c.DOM.createElement("div"); c.DOM.setStyle(this.containerEl, { left: 0, top: 0, width: c.DOM.windowWidth(), height: c.DOM.windowHeight(), position: "absolute", zIndex: 1 }); c.DOM.appendChild(this.imageEl, this.containerEl); c.DOM.appendChild(this.containerEl, this.el); c.Animation.resetTranslate(this.containerEl); c.Animation.resetTranslate(this.imageEl); this.transformEl = this.containerEl } else { c.DOM.appendChild(this.imageEl, this.el); this.transformEl = this.imageEl } }, setStartingTranslateFromCurrentTransform: function () { var b = c.coalesce(this.transformEl.style.webkitTransform, this.transformEl.style.MozTransform, this.transformEl.style.transform), d; if (!c.isNothing(b)) { d = b.match(/translate\((.*?)\)/); if (!c.isNothing(d)) { d = d[1].split(", "); this.transformSettings.startingTranslateX = a.parseInt(d[0], 10); this.transformSettings.startingTranslateY = a.parseInt(d[1], 10) } } }, getScale: function (a) { var b = this.transformSettings.startingScale * a; if (this.settings.minUserZoom !== 0 && b < this.settings.minUserZoom) { b = this.settings.minUserZoom } else if (this.settings.maxUserZoom !== 0 && b > this.settings.maxUserZoom) { b = this.settings.maxUserZoom } return b }, setStartingScaleAndRotation: function (a, b) { this.transformSettings.startingScale = this.getScale(a); this.transformSettings.startingRotation = (this.transformSettings.startingRotation + b) % 360 }, zoomRotate: function (a, b) { this.transformSettings.scale = this.getScale(a); this.transformSettings.rotation = this.transformSettings.startingRotation + b; this.applyTransform() }, panStart: function (a) { this.setStartingTranslateFromCurrentTransform(); this.panStartingPoint = { x: a.x, y: a.y} }, pan: function (a) { var b = a.x - this.panStartingPoint.x, c = a.y - this.panStartingPoint.y, d = b / this.transformSettings.scale, e = c / this.transformSettings.scale; this.transformSettings.translateX = this.transformSettings.startingTranslateX + d; this.transformSettings.translateY = this.transformSettings.startingTranslateY + e; this.applyTransform() }, zoomAndPanToPoint: function (a, b) { this.panStart({ x: c.DOM.bodyWidth() / 2, y: c.DOM.windowHeight() / 2 }); var d = b.x - this.panStartingPoint.x, e = b.y - this.panStartingPoint.y, f = d / this.transformSettings.scale, g = e / this.transformSettings.scale; this.transformSettings.translateX = (this.transformSettings.startingTranslateX + f) * -1; this.transformSettings.translateY = (this.transformSettings.startingTranslateY + g) * -1; this.setStartingScaleAndRotation(a, 0); this.transformSettings.scale = this.transformSettings.startingScale; this.transformSettings.rotation = 0; this.applyTransform() }, applyTransform: function () { var b = "scale(" + this.transformSettings.scale + ") rotate(" + this.transformSettings.rotation % 360 + "deg) translate(" + a.parseInt(this.transformSettings.translateX, 10) + "px, " + a.parseInt(this.transformSettings.translateY, 10) + "px)"; c.DOM.setStyle(this.transformEl, { webkitTransform: b, MozTransform: b, msTransform: b, transform: b }) } }) })(window, window.klass, window.Code.Util); (function (a, b) { b.registerNamespace("Code.PhotoSwipe"); var c = a.Code.PhotoSwipe; c.CssClasses = { buildingBody: "ps-building", activeBody: "ps-active" }; c.EventTypes = { onBeforeShow: "PhotoSwipeOnBeforeShow", onShow: "PhotoSwipeOnShow", onBeforeHide: "PhotoSwipeOnBeforeHide", onHide: "PhotoSwipeOnHide", onDisplayImage: "PhotoSwipeOnDisplayImage", onResetPosition: "PhotoSwipeOnResetPosition", onSlideshowStart: "PhotoSwipeOnSlideshowStart", onSlideshowStop: "PhotoSwipeOnSlideshowStop", onTouch: "PhotoSwipeOnTouch", onBeforeCaptionAndToolbarShow: "PhotoSwipeOnBeforeCaptionAndToolbarShow", onCaptionAndToolbarShow: "PhotoSwipeOnCaptionAndToolbarShow", onBeforeCaptionAndToolbarHide: "PhotoSwipeOnBeforeCaptionAndToolbarHide", onCaptionAndToolbarHide: "PhotoSwipeOnCaptionAndToolbarHide", onToolbarTap: "PhotoSwipeOnToolbarTap" }; c.instances = []; c.activeInstance = null; c.setActivateInstance = function (a) { if (!b.isNothing(c.activeInstance)) { throw "Code.PhotoSwipe.activateInstance: Unable to active instance as another instance is already active" } c.activeInstance = a }; c.unsetActivateInstance = function () { c.activeInstance = null }; c.attach = function (a, d, e) { var f, g, h; g = c.createInstance(a, d, e); for (f = 0; f < a.length; f++) { h = a[f]; if (!b.isNothing(h.nodeType)) { if (h.nodeType === 1) { h.__photoSwipeClickHandler = c.onTriggerElementClick.bind(g); b.Events.remove(h, "click", h.__photoSwipeClickHandler); b.Events.add(h, "click", h.__photoSwipeClickHandler) } } } return g }; if (a.jQuery) { a.jQuery.fn.photoSwipe = function (a, b) { return c.attach(this, a, b) } } c.detatch = function (a) { var d, e; for (d = 0; d < a.originalImages.length; d++) { e = a.originalImages[d]; if (!b.isNothing(e.nodeType)) { if (e.nodeType === 1) { b.Events.remove(e, "click", e.__photoSwipeClickHandler); delete e.__photoSwipeClickHandler } } } c.disposeInstance(a) }; c.createInstance = function (a, d, e) { var f, g, h; if (b.isNothing(a)) { throw "Code.PhotoSwipe.attach: No images passed." } if (!b.isLikeArray(a)) { throw "Code.PhotoSwipe.createInstance: Images must be an array of elements or image urls." } if (a.length < 1) { throw "Code.PhotoSwipe.createInstance: No images to passed." } d = b.coalesce(d, {}); g = c.getInstance(e); if (b.isNothing(g)) { g = new c.PhotoSwipeClass(a, d, e); c.instances.push(g) } else { throw 'Code.PhotoSwipe.createInstance: Instance with id "' + e + ' already exists."' } return g }; c.disposeInstance = function (a) { var b = c.getInstanceIndex(a); if (b < 0) { throw "Code.PhotoSwipe.disposeInstance: Unable to find instance to dispose." } a.dispose(); c.instances.splice(b, 1); a = null }; c.onTriggerElementClick = function (a) { a.preventDefault(); var b = this; b.show(a.currentTarget) }; c.getInstance = function (a) { var b, d; for (b = 0; b < c.instances.length; b++) { d = c.instances[b]; if (d.id === a) { return d } } return null }; c.getInstanceIndex = function (a) { var b, d = -1; for (b = 0; b < c.instances.length; b++) { if (c.instances[b] === a) { d = b; break } } return d } })(window, window.Code.Util); (function (a, b, c, d, e, f, g, h, i) { c.registerNamespace("Code.PhotoSwipe"); var j = a.Code.PhotoSwipe; j.PhotoSwipeClass = b({ id: null, settings: null, isBackEventSupported: null, backButtonClicked: null, currentIndex: null, originalImages: null, mouseWheelStartTime: null, cache: null, documentOverlay: null, carousel: null, uiLayer: null, toolbar: null, zoomPanRotate: null, windowOrientationChangeHandler: null, windowScrollHandler: null, windowHashChangeHandler: null, keyDownHandler: null, windowOrientationEventName: null, uiLayerTouchHandler: null, carouselSlideByEndHandler: null, carouselSlideshowStartHandler: null, carouselSlideshowStopHandler: null, toolbarTapHandler: null, toolbarBeforeShowHandler: null, toolbarShowHandler: null, toolbarBeforeHideHandler: null, toolbarHideHandler: null, mouseWheelHandler: null, dispose: function () { var a; c.Events.remove(this, j.EventTypes.onBeforeShow); c.Events.remove(this, j.EventTypes.onShow); c.Events.remove(this, j.EventTypes.onBeforeHide); c.Events.remove(this, j.EventTypes.onHide); c.Events.remove(this, j.EventTypes.onDisplayImage); c.Events.remove(this, j.EventTypes.onResetPosition); c.Events.remove(this, j.EventTypes.onSlideshowStart); c.Events.remove(this, j.EventTypes.onSlideshowStop); c.Events.remove(this, j.EventTypes.onTouch); c.Events.remove(this, j.EventTypes.onBeforeCaptionAndToolbarShow); c.Events.remove(this, j.EventTypes.onCaptionAndToolbarShow); c.Events.remove(this, j.EventTypes.onBeforeCaptionAndToolbarHide); c.Events.remove(this, j.EventTypes.onCaptionAndToolbarHide); this.removeEventHandlers(); if (!c.isNothing(this.documentOverlay)) { this.documentOverlay.dispose() } if (!c.isNothing(this.carousel)) { this.carousel.dispose() } if (!c.isNothing(this.uiLayer)) { this.uiLayer.dispose() } if (!c.isNothing(this.toolbar)) { this.toolbar.dispose() } this.destroyZoomPanRotate(); if (!c.isNothing(this.cache)) { this.cache.dispose() } for (a in this) { if (c.objectHasProperty(this, a)) { this[a] = null } } }, initialize: function (b, e, f) { if (c.isNothing(f)) { this.id = "PhotoSwipe" + (new Date).getTime().toString() } else { this.id = f } this.originalImages = b; if (c.Browser.isAndroid) { if (a.navigator.userAgent.indexOf("2.1") > -1) { this.isBackEventSupported = true } } if (!this.isBackEventSupported) { this.isBackEventSupported = c.objectHasProperty(a, "onhashchange") } this.settings = { fadeInSpeed: 250, fadeOutSpeed: 250, preventHide: false, preventSlideshow: false, zIndex: 1e3, backButtonHideEnabled: true, enableKeyboard: true, enableMouseWheel: true, mouseWheelSpeed: 350, autoStartSlideshow: false, jQueryMobile: !c.isNothing(a.jQuery) && !c.isNothing(a.jQuery.mobile), jQueryMobileDialogHash: "&ui-state=dialog", loop: true, slideSpeed: 250, nextPreviousSlideSpeed: 0, enableDrag: true, swipeThreshold: 50, swipeTimeThreshold: 250, slideTimingFunction: "ease-out", slideshowDelay: 3e3, doubleTapSpeed: 250, margin: 20, imageScaleMethod: "fit", captionAndToolbarHide: false, captionAndToolbarFlipPosition: false, captionAndToolbarAutoHideDelay: 5e3, captionAndToolbarOpacity: .8, captionAndToolbarShowEmptyCaptions: true, getToolbar: j.Toolbar.getToolbar, allowUserZoom: true, allowRotationOnUserZoom: false, maxUserZoom: 5, minUserZoom: .5, doubleTapZoomLevel: 2.5, getImageSource: j.Cache.Functions.getImageSource, getImageCaption: j.Cache.Functions.getImageCaption, getImageMetaData: j.Cache.Functions.getImageMetaData, cacheMode: j.Cache.Mode.normal }; c.extend(this.settings, e); if (this.settings.preventHide) { this.settings.backButtonHideEnabled = false } this.cache = new d.CacheClass(b, this.settings) }, show: function (b) { var d; if (c.isNumber(b)) { this.currentIndex = b } else { this.currentIndex = -1; for (d = 0; d < this.originalImages.length; d++) { if (this.originalImages[d] === b) { this.currentIndex = d; break } } } if (this.currentIndex < 0 || this.currentIndex > this.originalImages.length - 1) { throw "Code.PhotoSwipe.PhotoSwipeClass.show: Starting index out of range" } j.setActivateInstance(this); c.DOM.addClass(a.document.body, j.CssClasses.buildingBody); this.createComponents(); c.Events.fire(this, { type: j.EventTypes.onBeforeShow, target: this }); this.documentOverlay.fadeIn(this.settings.fadeInSpeed, this.onDocumentOverlayFadeIn.bind(this)) }, createComponents: function () { this.documentOverlay = new e.DocumentOverlayClass(this.settings); this.carousel = new f.CarouselClass(this.cache, this.settings); this.uiLayer = new h.UILayerClass(this.settings); if (!this.settings.captionAndToolbarHide) { this.toolbar = new g.ToolbarClass(this.cache, this.settings) } }, resetPosition: function () { this.destroyZoomPanRotate(); this.documentOverlay.resetPosition(); this.carousel.resetPosition(); if (!c.isNothing(this.toolbar)) { this.toolbar.resetPosition() } this.uiLayer.resetPosition(); c.Events.fire(this, { type: j.EventTypes.onResetPosition, target: this }) }, addEventHandler: function (a, b) { c.Events.add(this, a, b) }, addEventHandlers: function () { if (c.isNothing(this.windowOrientationChangeHandler)) { this.windowOrientationChangeHandler = this.onWindowOrientationChange.bind(this); this.windowScrollHandler = this.onWindowScroll.bind(this); this.keyDownHandler = this.onKeyDown.bind(this); this.windowHashChangeHandler = this.onWindowHashChange.bind(this); this.uiLayerTouchHandler = this.onUILayerTouch.bind(this); this.carouselSlideByEndHandler = this.onCarouselSlideByEnd.bind(this); this.carouselSlideshowStartHandler = this.onCarouselSlideshowStart.bind(this); this.carouselSlideshowStopHandler = this.onCarouselSlideshowStop.bind(this); this.toolbarTapHandler = this.onToolbarTap.bind(this); this.toolbarBeforeShowHandler = this.onToolbarBeforeShow.bind(this); this.toolbarShowHandler = this.onToolbarShow.bind(this); this.toolbarBeforeHideHandler = this.onToolbarBeforeHide.bind(this); this.toolbarHideHandler = this.onToolbarHide.bind(this); this.mouseWheelHandler = this.onMouseWheel.bind(this) } if (c.Browser.android) { this.orientationEventName = "resize" } else if (c.Browser.iOS && !c.Browser.safari) { c.Events.add(a.document.body, "orientationchange", this.windowOrientationChangeHandler) } else { var b = !c.isNothing(a.onorientationchange); this.orientationEventName = b ? "orientationchange" : "resize" } if (!c.isNothing(this.orientationEventName)) { c.Events.add(a, this.orientationEventName, this.windowOrientationChangeHandler) } c.Events.add(a, "scroll", this.windowScrollHandler); if (this.settings.enableKeyboard) { c.Events.add(a.document, "keydown", this.keyDownHandler) } if (this.isBackEventSupported && this.settings.backButtonHideEnabled) { this.windowHashChangeHandler = this.onWindowHashChange.bind(this); if (this.settings.jQueryMobile) { a.location.hash = this.settings.jQueryMobileDialogHash } else { this.currentHistoryHashValue = "PhotoSwipe" + (new Date).getTime().toString(); a.location.hash = this.currentHistoryHashValue } c.Events.add(a, "hashchange", this.windowHashChangeHandler) } if (this.settings.enableMouseWheel) { c.Events.add(a, "mousewheel", this.mouseWheelHandler) } c.Events.add(this.uiLayer, j.TouchElement.EventTypes.onTouch, this.uiLayerTouchHandler); c.Events.add(this.carousel, f.EventTypes.onSlideByEnd, this.carouselSlideByEndHandler); c.Events.add(this.carousel, f.EventTypes.onSlideshowStart, this.carouselSlideshowStartHandler); c.Events.add(this.carousel, f.EventTypes.onSlideshowStop, this.carouselSlideshowStopHandler); if (!c.isNothing(this.toolbar)) { c.Events.add(this.toolbar, g.EventTypes.onTap, this.toolbarTapHandler); c.Events.add(this.toolbar, g.EventTypes.onBeforeShow, this.toolbarBeforeShowHandler); c.Events.add(this.toolbar, g.EventTypes.onShow, this.toolbarShowHandler); c.Events.add(this.toolbar, g.EventTypes.onBeforeHide, this.toolbarBeforeHideHandler); c.Events.add(this.toolbar, g.EventTypes.onHide, this.toolbarHideHandler) } }, removeEventHandlers: function () { if (c.Browser.iOS && !c.Browser.safari) { c.Events.remove(a.document.body, "orientationchange", this.windowOrientationChangeHandler) } if (!c.isNothing(this.orientationEventName)) { c.Events.remove(a, this.orientationEventName, this.windowOrientationChangeHandler) } c.Events.remove(a, "scroll", this.windowScrollHandler); if (this.settings.enableKeyboard) { c.Events.remove(a.document, "keydown", this.keyDownHandler) } if (this.isBackEventSupported && this.settings.backButtonHideEnabled) { c.Events.remove(a, "hashchange", this.windowHashChangeHandler) } c.Events.remove(this.uiLayer, j.TouchElement.EventTypes.onTouch, this.uiLayerTouchHandler); c.Events.remove(this.carousel, f.EventTypes.onSlideByEnd, this.carouselSlideByEndHandler); c.Events.remove(this.carousel, f.EventTypes.onSlideshowStart, this.carouselSlideshowStartHandler); c.Events.remove(this.carousel, f.EventTypes.onSlideshowStop, this.carouselSlideshowStopHandler); if (this.settings.enableMouseWheel) { c.Events.remove(a, "mousewheel", this.mouseWheelHandler) } if (!c.isNothing(this.toolbar)) { c.Events.remove(this.toolbar, g.EventTypes.onTap, this.toolbarTapHandler); c.Events.remove(this.toolbar, g.EventTypes.onBeforeShow, this.toolbarBeforeShowHandler); c.Events.remove(this.toolbar, g.EventTypes.onShow, this.toolbarShowHandler); c.Events.remove(this.toolbar, g.EventTypes.onBeforeHide, this.toolbarBeforeHideHandler); c.Events.remove(this.toolbar, g.EventTypes.onHide, this.toolbarHideHandler) } }, hide: function () { if (this.settings.preventHide) { return } this.removeEventHandlers(); c.Events.fire(this, { type: j.EventTypes.onBeforeHide, target: this }); this.uiLayer.dispose(); this.uiLayer = null; if (!c.isNothing(this.toolbar)) { this.toolbar.dispose(); this.toolbar = null } this.carousel.dispose(); this.carousel = null; c.DOM.removeClass(a.document.body, j.CssClasses.activeBody); this.documentOverlay.dispose(); this.documentOverlay = null; j.unsetActivateInstance(); c.Events.fire(this, { type: j.EventTypes.onHide, target: this }); this.goBackInHistory() }, goBackInHistory: function () { if (this.isBackEventSupported && this.settings.backButtonHideEnabled) { if (!this.backButtonClicked) { a.history.back() } } }, play: function () { if (!this.settings.preventSlideshow) { if (!c.isNothing(this.carousel)) { this.fadeOutToolbarIfVisible(); this.carousel.startSlideshow() } } }, stop: function () { if (!c.isNothing(this.carousel)) { this.carousel.stopSlideshow() } }, previous: function () { if (!c.isNothing(this.carousel)) { this.carousel.previous() } }, next: function () { if (!c.isNothing(this.carousel)) { this.carousel.next() } }, toggleToolbar: function () { if (!c.isNothing(this.toolbar)) { this.toolbar.toggleVisibility(this.currentIndex) } }, fadeOutToolbarIfVisible: function () { if (!c.isNothing(this.toolbar) && this.toolbar.isVisible && this.settings.captionAndToolbarAutoHideDelay > 0) { this.toolbar.fadeOut() } }, createZoomPanRotate: function () { this.stop(); if (this.canUserZoom() && !this.isZoomActive()) { this.zoomPanRotate = new i.ZoomPanRotateClass(this.settings, this.cache.images[this.currentIndex], this.uiLayer); this.fadeOutToolbarIfVisible() } }, destroyZoomPanRotate: function () { if (!c.isNothing(this.zoomPanRotate)) { this.zoomPanRotate.dispose(); this.zoomPanRotate = null } }, canUserZoom: function () { var a, b; if (c.Browser.msie) { a = document.createElement("div"); if (c.isNothing(a.style.msTransform)) { return false } } else if (!c.Browser.isCSSTransformSupported) { return false } if (!this.settings.allowUserZoom) { return false } if (this.carousel.isSliding) { return false } b = this.cache.images[this.currentIndex]; if (c.isNothing(b)) { return false } if (b.isLoading) { return false } return true }, isZoomActive: function () { return !c.isNothing(this.zoomPanRotate) }, getCurrentImage: function () { return this.cache.images[this.currentIndex] }, onDocumentOverlayFadeIn: function (b) { a.setTimeout(function () { c.DOM.removeClass(a.document.body, j.CssClasses.buildingBody); c.DOM.addClass(a.document.body, j.CssClasses.activeBody); this.addEventHandlers(); this.carousel.show(this.currentIndex); this.uiLayer.show(); if (this.settings.autoStartSlideshow) { this.play() } else if (!c.isNothing(this.toolbar)) { this.toolbar.show(this.currentIndex) } c.Events.fire(this, { type: j.EventTypes.onShow, target: this }) } .bind(this), 250) }, onWindowScroll: function (a) { this.resetPosition() }, onWindowOrientationChange: function (a) { this.resetPosition() }, onWindowHashChange: function (b) { var c = "#" + (this.settings.jQueryMobile ? this.settings.jQueryMobileDialogHash : this.currentHistoryHashValue); if (a.location.hash !== c) { this.backButtonClicked = true; this.hide() } }, onKeyDown: function (a) { if (a.keyCode === 37) { a.preventDefault(); this.previous() } else if (a.keyCode === 39) { a.preventDefault(); this.next() } else if (a.keyCode === 38 || a.keyCode === 40) { a.preventDefault() } else if (a.keyCode === 27) { a.preventDefault(); this.hide() } else if (a.keyCode === 32) { if (!this.settings.hideToolbar) { this.toggleToolbar() } else { this.hide() } a.preventDefault() } else if (a.keyCode === 13) { a.preventDefault(); this.play() } }, onUILayerTouch: function (b) { if (this.isZoomActive()) { switch (b.action) { case j.TouchElement.ActionTypes.gestureChange: this.zoomPanRotate.zoomRotate(b.scale, this.settings.allowRotationOnUserZoom ? b.rotation : 0); break; case j.TouchElement.ActionTypes.gestureEnd: this.zoomPanRotate.setStartingScaleAndRotation(b.scale, this.settings.allowRotationOnUserZoom ? b.rotation : 0); break; case j.TouchElement.ActionTypes.touchStart: this.zoomPanRotate.panStart(b.point); break; case j.TouchElement.ActionTypes.touchMove: this.zoomPanRotate.pan(b.point); break; case j.TouchElement.ActionTypes.doubleTap: this.destroyZoomPanRotate(); this.toggleToolbar(); break; case j.TouchElement.ActionTypes.swipeLeft: this.destroyZoomPanRotate(); this.next(); this.toggleToolbar(); break; case j.TouchElement.ActionTypes.swipeRight: this.destroyZoomPanRotate(); this.previous(); this.toggleToolbar(); break } } else { switch (b.action) { case j.TouchElement.ActionTypes.touchMove: case j.TouchElement.ActionTypes.swipeLeft: case j.TouchElement.ActionTypes.swipeRight: this.fadeOutToolbarIfVisible(); this.carousel.onTouch(b.action, b.point); break; case j.TouchElement.ActionTypes.touchStart: case j.TouchElement.ActionTypes.touchEnd: this.carousel.onTouch(b.action, b.point); break; case j.TouchElement.ActionTypes.tap: this.toggleToolbar(); break; case j.TouchElement.ActionTypes.doubleTap: b.point.x -= c.DOM.windowScrollLeft(); b.point.y -= c.DOM.windowScrollTop(); var d = this.cache.images[this.currentIndex].imageEl, e = a.parseInt(c.DOM.getStyle(d, "top"), 10), f = a.parseInt(c.DOM.getStyle(d, "left"), 10), g = f + c.DOM.width(d), h = e + c.DOM.height(d); if (b.point.x < f) { b.point.x = f } else if (b.point.x > g) { b.point.x = g } if (b.point.y < e) { b.point.y = e } else if (b.point.y > h) { b.point.y = h } this.createZoomPanRotate(); if (this.isZoomActive()) { this.zoomPanRotate.zoomAndPanToPoint(this.settings.doubleTapZoomLevel, b.point) } break; case j.TouchElement.ActionTypes.gestureStart: this.createZoomPanRotate(); break } } c.Events.fire(this, { type: j.EventTypes.onTouch, target: this, point: b.point, action: b.action }) }, onCarouselSlideByEnd: function (a) { this.currentIndex = a.cacheIndex; if (!c.isNothing(this.toolbar)) { this.toolbar.setCaption(this.currentIndex); this.toolbar.setToolbarStatus(this.currentIndex) } c.Events.fire(this, { type: j.EventTypes.onDisplayImage, target: this, action: a.action, index: a.cacheIndex }) }, onToolbarTap: function (a) { switch (a.action) { case g.ToolbarAction.next: this.next(); break; case g.ToolbarAction.previous: this.previous(); break; case g.ToolbarAction.close: this.hide(); break; case g.ToolbarAction.play: this.play(); break } c.Events.fire(this, { type: j.EventTypes.onToolbarTap, target: this, toolbarAction: a.action, tapTarget: a.tapTarget }) }, onMouseWheel: function (a) { var b = c.Events.getWheelDelta(a), d = a.timeStamp - (this.mouseWheelStartTime || 0); if (d < this.settings.mouseWheelSpeed) { return } this.mouseWheelStartTime = a.timeStamp; if (this.settings.invertMouseWheel) { b = b * -1 } if (b < 0) { this.next() } else if (b > 0) { this.previous() } }, onCarouselSlideshowStart: function (a) { c.Events.fire(this, { type: j.EventTypes.onSlideshowStart, target: this }) }, onCarouselSlideshowStop: function (a) { c.Events.fire(this, { type: j.EventTypes.onSlideshowStop, target: this }) }, onToolbarBeforeShow: function (a) { c.Events.fire(this, { type: j.EventTypes.onBeforeCaptionAndToolbarShow, target: this }) }, onToolbarShow: function (a) { c.Events.fire(this, { type: j.EventTypes.onCaptionAndToolbarShow, target: this }) }, onToolbarBeforeHide: function (a) { c.Events.fire(this, { type: j.EventTypes.onBeforeCaptionAndToolbarHide, target: this }) }, onToolbarHide: function (a) { c.Events.fire(this, { type: j.EventTypes.onCaptionAndToolbarHide, target: this }) } }) })(window, window.klass, window.Code.Util, window.Code.PhotoSwipe.Cache, window.Code.PhotoSwipe.DocumentOverlay, window.Code.PhotoSwipe.Carousel, window.Code.PhotoSwipe.Toolbar, window.Code.PhotoSwipe.UILayer, window.Code.PhotoSwipe.ZoomPanRotate); (function (a) { function i(b) { var d = a(b).data(c); return !d || !d.validate || d.validate() } function h(b, c) { var h, i, j, k; h = b.getAttribute("data-ajax-confirm"); if (h && !window.confirm(h)) { return } i = a(b.getAttribute("data-ajax-loading")); k = b.getAttribute("data-ajax-loading-duration") || 0; a.extend(c, { type: b.getAttribute("data-ajax-method") || undefined, url: b.getAttribute("data-ajax-url") || undefined, beforeSend: function (a) { var c; f(a, j); c = d(b.getAttribute("data-ajax-begin"), ["xhr"]).apply(this, arguments); if (c !== false) { i.show(k) } return c }, complete: function () { i.hide(k); d(b.getAttribute("data-ajax-complete"), ["xhr", "status"]).apply(this, arguments) }, success: function (a, c, e) { g(b, a, e.getResponseHeader("Content-Type") || "text/html"); d(b.getAttribute("data-ajax-success"), ["data", "status", "xhr"]).apply(this, arguments) }, error: d(b.getAttribute("data-ajax-failure"), ["xhr", "status", "error"]) }); c.data.push({ name: "X-Requested-With", value: "XMLHttpRequest" }); j = c.type.toUpperCase(); if (!e(j)) { c.type = "POST"; c.data.push({ name: "X-HTTP-Method-Override", value: j }) } a.ajax(c) } function g(b, c, d) { var e; if (d.indexOf("application/x-javascript") !== -1) { return } e = (b.getAttribute("data-ajax-mode") || "").toUpperCase(); a(b.getAttribute("data-ajax-update")).each(function (b, d) { var f; switch (e) { case "BEFORE": f = d.firstChild; a("<div />").html(c).contents().each(function () { d.insertBefore(this, f) }); break; case "AFTER": a("<div />").html(c).contents().each(function () { d.appendChild(this) }); break; default: a(d).html(c); break } }) } function f(a, b) { if (!e(b)) { a.setRequestHeader("X-HTTP-Method-Override", b) } } function e(a) { return a === "GET" || a === "POST" } function d(a, b) { var c = window, d = (a || "").split("."); while (c && d.length) { c = c[d.shift()] } if (typeof c === "function") { return c } b.push(a); return Function.constructor.apply(null, b) } var b = "unobtrusiveAjaxClick", c = "unobtrusiveValidation"; a("a[data-ajax=true]").live("click", function (a) { a.preventDefault(); h(this, { url: this.href, type: "GET", data: [] }) }); a("form[data-ajax=true] input[type=image]").live("click", function (c) { var d = c.target.name, e = a(c.target), f = e.parents("form")[0], g = e.offset(); a(f).data(b, [{ name: d + ".x", value: Math.round(c.pageX - g.left) }, { name: d + ".y", value: Math.round(c.pageY - g.top)}]); setTimeout(function () { a(f).removeData(b) }, 0) }); a("form[data-ajax=true] :submit").live("click", function (c) { var d = c.target.name, e = a(c.target).parents("form")[0]; a(e).data(b, d ? [{ name: d, value: c.target.value}] : []); setTimeout(function () { a(e).removeData(b) }, 0) }); a("form[data-ajax=true]").live("submit", function (c) { var d = a(this).data(b) || []; c.preventDefault(); if (!i(this)) { return } h(this, { url: this.action, type: this.method || "GET", data: d.concat(a(this).serializeArray()) }) }) })(jQuery); (function (a) { a.extend(a.fn, { validate: function (b) { if (!this.length) { b && b.debug && window.console && console.warn("nothing selected, can't validate, returning nothing"); return } var c = a.data(this[0], "validator"); if (c) { return c } c = new a.validator(b, this[0]); a.data(this[0], "validator", c); if (c.settings.onsubmit) { this.find("input, button").filter(".cancel").click(function () { c.cancelSubmit = true }); if (c.settings.submitHandler) { this.find("input, button").filter(":submit").click(function () { c.submitButton = this }) } this.submit(function (b) { function d() { if (c.settings.submitHandler) { if (c.submitButton) { var b = a("<input type='hidden'/>").attr("name", c.submitButton.name).val(c.submitButton.value).appendTo(c.currentForm) } c.settings.submitHandler.call(c, c.currentForm); if (c.submitButton) { b.remove() } return false } return true } if (c.settings.debug) b.preventDefault(); if (c.cancelSubmit) { c.cancelSubmit = false; return d() } if (c.form()) { if (c.pendingRequest) { c.formSubmitted = true; return false } return d() } else { c.focusInvalid(); return false } }) } return c }, valid: function () { if (a(this[0]).is("form")) { return this.validate().form() } else { var b = true; var c = a(this[0].form).validate(); this.each(function () { b &= c.element(this) }); return b } }, removeAttrs: function (b) { var c = {}, d = this; a.each(b.split(/\s/), function (a, b) { c[b] = d.attr(b); d.removeAttr(b) }); return c }, rules: function (b, c) { var d = this[0]; if (b) { var e = a.data(d.form, "validator").settings; var f = e.rules; var g = a.validator.staticRules(d); switch (b) { case "add": a.extend(g, a.validator.normalizeRule(c)); f[d.name] = g; if (c.messages) e.messages[d.name] = a.extend(e.messages[d.name], c.messages); break; case "remove": if (!c) { delete f[d.name]; return g } var h = {}; a.each(c.split(/\s/), function (a, b) { h[b] = g[b]; delete g[b] }); return h } } var i = a.validator.normalizeRules(a.extend({}, a.validator.metadataRules(d), a.validator.classRules(d), a.validator.attributeRules(d), a.validator.staticRules(d)), d); if (i.required) { var j = i.required; delete i.required; i = a.extend({ required: j }, i) } return i } }); a.extend(a.expr[":"], { blank: function (b) { return !a.trim("" + b.value) }, filled: function (b) { return !!a.trim("" + b.value) }, unchecked: function (a) { return !a.checked } }); a.validator = function (b, c) { this.settings = a.extend(true, {}, a.validator.defaults, b); this.currentForm = c; this.init() }; a.validator.format = function (b, c) { if (arguments.length == 1) return function () { var c = a.makeArray(arguments); c.unshift(b); return a.validator.format.apply(this, c) }; if (arguments.length > 2 && c.constructor != Array) { c = a.makeArray(arguments).slice(1) } if (c.constructor != Array) { c = [c] } a.each(c, function (a, c) { b = b.replace(new RegExp("\\{" + a + "\\}", "g"), c) }); return b }; a.extend(a.validator, { defaults: { messages: {}, groups: {}, rules: {}, errorClass: "error", validClass: "valid", errorElement: "label", focusInvalid: true, errorContainer: a([]), errorLabelContainer: a([]), onsubmit: true, ignore: [], ignoreTitle: false, onfocusin: function (a) { this.lastActive = a; if (this.settings.focusCleanup && !this.blockFocusCleanup) { this.settings.unhighlight && this.settings.unhighlight.call(this, a, this.settings.errorClass, this.settings.validClass); this.errorsFor(a).hide() } }, onfocusout: function (a) { if (!this.checkable(a) && (a.name in this.submitted || !this.optional(a))) { this.element(a) } }, onkeyup: function (a) { if (a.name in this.submitted || a == this.lastElement) { this.element(a) } }, onclick: function (a) { if (a.name in this.submitted) this.element(a); else if (a.parentNode.name in this.submitted) this.element(a.parentNode) }, highlight: function (b, c, d) { a(b).addClass(c).removeClass(d) }, unhighlight: function (b, c, d) { a(b).removeClass(c).addClass(d) } }, setDefaults: function (b) { a.extend(a.validator.defaults, b) }, messages: { required: "This field is required.", remote: "Please fix this field.", email: "Please enter a valid email address.", url: "Please enter a valid URL.", date: "Please enter a valid date.", dateISO: "Please enter a valid date (ISO).", number: "Please enter a valid number.", digits: "Please enter only digits.", creditcard: "Please enter a valid credit card number.", equalTo: "Please enter the same value again.", accept: "Please enter a value with a valid extension.", maxlength: a.validator.format("Please enter no more than {0} characters."), minlength: a.validator.format("Please enter at least {0} characters."), rangelength: a.validator.format("Please enter a value between {0} and {1} characters long."), range: a.validator.format("Please enter a value between {0} and {1}."), max: a.validator.format("Please enter a value less than or equal to {0}."), min: a.validator.format("Please enter a value greater than or equal to {0}.") }, autoCreateRanges: false, prototype: { init: function () { function d(b) { var c = a.data(this[0].form, "validator"), d = "on" + b.type.replace(/^validate/, ""); c.settings[d] && c.settings[d].call(c, this[0]) } this.labelContainer = a(this.settings.errorLabelContainer); this.errorContext = this.labelContainer.length && this.labelContainer || a(this.currentForm); this.containers = a(this.settings.errorContainer).add(this.settings.errorLabelContainer); this.submitted = {}; this.valueCache = {}; this.pendingRequest = 0; this.pending = {}; this.invalid = {}; this.reset(); var b = this.groups = {}; a.each(this.settings.groups, function (c, d) { a.each(d.split(/\s/), function (a, d) { b[d] = c }) }); var c = this.settings.rules; a.each(c, function (b, d) { c[b] = a.validator.normalizeRule(d) }); a(this.currentForm).validateDelegate(":text, :password, :file, select, textarea", "focusin focusout keyup", d).validateDelegate(":radio, :checkbox, select, option", "click", d); if (this.settings.invalidHandler) a(this.currentForm).bind("invalid-form.validate", this.settings.invalidHandler) }, form: function () { this.checkForm(); a.extend(this.submitted, this.errorMap); this.invalid = a.extend({}, this.errorMap); if (!this.valid()) a(this.currentForm).triggerHandler("invalid-form", [this]); this.showErrors(); return this.valid() }, checkForm: function () { this.prepareForm(); for (var a = 0, b = this.currentElements = this.elements(); b[a]; a++) { this.check(b[a]) } return this.valid() }, element: function (b) { b = this.clean(b); this.lastElement = b; this.prepareElement(b); this.currentElements = a(b); var c = this.check(b); if (c) { delete this.invalid[b.name] } else { this.invalid[b.name] = true } if (!this.numberOfInvalids()) { this.toHide = this.toHide.add(this.containers) } this.showErrors(); return c }, showErrors: function (b) { if (b) { a.extend(this.errorMap, b); this.errorList = []; for (var c in b) { this.errorList.push({ message: b[c], element: this.findByName(c)[0] }) } this.successList = a.grep(this.successList, function (a) { return !(a.name in b) }) } this.settings.showErrors ? this.settings.showErrors.call(this, this.errorMap, this.errorList) : this.defaultShowErrors() }, resetForm: function () { if (a.fn.resetForm) a(this.currentForm).resetForm(); this.submitted = {}; this.prepareForm(); this.hideErrors(); this.elements().removeClass(this.settings.errorClass) }, numberOfInvalids: function () { return this.objectLength(this.invalid) }, objectLength: function (a) { var b = 0; for (var c in a) b++; return b }, hideErrors: function () { this.addWrapper(this.toHide).hide() }, valid: function () { return this.size() == 0 }, size: function () { return this.errorList.length }, focusInvalid: function () { if (this.settings.focusInvalid) { try { a(this.findLastActive() || this.errorList.length && this.errorList[0].element || []).filter(":visible").focus().trigger("focusin") } catch (b) { } } }, findLastActive: function () { var b = this.lastActive; return b && a.grep(this.errorList, function (a) { return a.element.name == b.name }).length == 1 && b }, elements: function () { var b = this, c = {}; return a([]).add(this.currentForm.elements).filter(":input").not(":submit, :reset, :image, [disabled]").not(this.settings.ignore).filter(function () { !this.name && b.settings.debug && window.console && console.error("%o has no name assigned", this); if (this.name in c || !b.objectLength(a(this).rules())) return false; c[this.name] = true; return true }) }, clean: function (b) { return a(b)[0] }, errors: function () { return a(this.settings.errorElement + "." + this.settings.errorClass, this.errorContext) }, reset: function () { this.successList = []; this.errorList = []; this.errorMap = {}; this.toShow = a([]); this.toHide = a([]); this.currentElements = a([]) }, prepareForm: function () { this.reset(); this.toHide = this.errors().add(this.containers) }, prepareElement: function (a) { this.reset(); this.toHide = this.errorsFor(a) }, check: function (b) { b = this.clean(b); if (this.checkable(b)) { b = this.findByName(b.name)[0] } var c = a(b).rules(); var d = false; for (method in c) { var e = { method: method, parameters: c[method] }; try { var f = a.validator.methods[method].call(this, b.value.replace(/\r/g, ""), b, e.parameters); if (f == "dependency-mismatch") { d = true; continue } d = false; if (f == "pending") { this.toHide = this.toHide.not(this.errorsFor(b)); return } if (!f) { this.formatAndAdd(b, e); return false } } catch (g) { this.settings.debug && window.console && console.log("exception occured when checking element " + b.id + ", check the '" + e.method + "' method", g); throw g } } if (d) return; if (this.objectLength(c)) this.successList.push(b); return true }, customMetaMessage: function (b, c) { if (!a.metadata) return; var d = this.settings.meta ? a(b).metadata()[this.settings.meta] : a(b).metadata(); return d && d.messages && d.messages[c] }, customMessage: function (a, b) { var c = this.settings.messages[a]; return c && (c.constructor == String ? c : c[b]) }, findDefined: function () { for (var a = 0; a < arguments.length; a++) { if (arguments[a] !== undefined) return arguments[a] } return undefined }, defaultMessage: function (b, c) { return this.findDefined(this.customMessage(b.name, c), this.customMetaMessage(b, c), !this.settings.ignoreTitle && b.title || undefined, a.validator.messages[c], "<strong>Warning: No message defined for " + b.name + "</strong>") }, formatAndAdd: function (a, b) { var c = this.defaultMessage(a, b.method), d = /\$?\{(\d+)\}/g; if (typeof c == "function") { c = c.call(this, b.parameters, a) } else if (d.test(c)) { c = jQuery.format(c.replace(d, "{$1}"), b.parameters) } this.errorList.push({ message: c, element: a }); this.errorMap[a.name] = c; this.submitted[a.name] = c }, addWrapper: function (a) { if (this.settings.wrapper) a = a.add(a.parent(this.settings.wrapper)); return a }, defaultShowErrors: function () { for (var a = 0; this.errorList[a]; a++) { var b = this.errorList[a]; this.settings.highlight && this.settings.highlight.call(this, b.element, this.settings.errorClass, this.settings.validClass); this.showLabel(b.element, b.message) } if (this.errorList.length) { this.toShow = this.toShow.add(this.containers) } if (this.settings.success) { for (var a = 0; this.successList[a]; a++) { this.showLabel(this.successList[a]) } } if (this.settings.unhighlight) { for (var a = 0, c = this.validElements(); c[a]; a++) { this.settings.unhighlight.call(this, c[a], this.settings.errorClass, this.settings.validClass) } } this.toHide = this.toHide.not(this.toShow); this.hideErrors(); this.addWrapper(this.toShow).show() }, validElements: function () { return this.currentElements.not(this.invalidElements()) }, invalidElements: function () { return a(this.errorList).map(function () { return this.element }) }, showLabel: function (b, c) { var d = this.errorsFor(b); if (d.length) { d.removeClass().addClass(this.settings.errorClass); d.attr("generated") && d.html(c) } else { d = a("<" + this.settings.errorElement + "/>").attr({ "for": this.idOrName(b), generated: true }).addClass(this.settings.errorClass).html(c || ""); if (this.settings.wrapper) { d = d.hide().show().wrap("<" + this.settings.wrapper + "/>").parent() } if (!this.labelContainer.append(d).length) this.settings.errorPlacement ? this.settings.errorPlacement(d, a(b)) : d.insertAfter(b) } if (!c && this.settings.success) { d.text(""); typeof this.settings.success == "string" ? d.addClass(this.settings.success) : this.settings.success(d) } this.toShow = this.toShow.add(d) }, errorsFor: function (b) { var c = this.idOrName(b); return this.errors().filter(function () { return a(this).attr("for") == c }) }, idOrName: function (a) { return this.groups[a.name] || (this.checkable(a) ? a.name : a.id || a.name) }, checkable: function (a) { return /radio|checkbox/i.test(a.type) }, findByName: function (b) { var c = this.currentForm; return a(document.getElementsByName(b)).map(function (a, d) { return d.form == c && d.name == b && d || null }) }, getLength: function (b, c) { switch (c.nodeName.toLowerCase()) { case "select": return a("option:selected", c).length; case "input": if (this.checkable(c)) return this.findByName(c.name).filter(":checked").length } return b.length }, depend: function (a, b) { return this.dependTypes[typeof a] ? this.dependTypes[typeof a](a, b) : true }, dependTypes: { "boolean": function (a, b) { return a }, string: function (b, c) { return !!a(b, c.form).length }, "function": function (a, b) { return a(b) } }, optional: function (b) { return !a.validator.methods.required.call(this, a.trim(b.value), b) && "dependency-mismatch" }, startRequest: function (a) { if (!this.pending[a.name]) { this.pendingRequest++; this.pending[a.name] = true } }, stopRequest: function (b, c) { this.pendingRequest--; if (this.pendingRequest < 0) this.pendingRequest = 0; delete this.pending[b.name]; if (c && this.pendingRequest == 0 && this.formSubmitted && this.form()) { a(this.currentForm).submit(); this.formSubmitted = false } else if (!c && this.pendingRequest == 0 && this.formSubmitted) { a(this.currentForm).triggerHandler("invalid-form", [this]); this.formSubmitted = false } }, previousValue: function (b) { return a.data(b, "previousValue") || a.data(b, "previousValue", { old: null, valid: true, message: this.defaultMessage(b, "remote") }) } }, classRuleSettings: { required: { required: true }, email: { email: true }, url: { url: true }, date: { date: true }, dateISO: { dateISO: true }, dateDE: { dateDE: true }, number: { number: true }, numberDE: { numberDE: true }, digits: { digits: true }, creditcard: { creditcard: true} }, addClassRules: function (b, c) { b.constructor == String ? this.classRuleSettings[b] = c : a.extend(this.classRuleSettings, b) }, classRules: function (b) { var c = {}; var d = a(b).attr("class"); d && a.each(d.split(" "), function () { if (this in a.validator.classRuleSettings) { a.extend(c, a.validator.classRuleSettings[this]) } }); return c }, attributeRules: function (b) { var c = {}; var d = a(b); for (method in a.validator.methods) { var e = d.attr(method); if (e) { c[method] = e } } if (c.maxlength && /-1|2147483647|524288/.test(c.maxlength)) { delete c.maxlength } return c }, metadataRules: function (b) { if (!a.metadata) return {}; var c = a.data(b.form, "validator").settings.meta; return c ? a(b).metadata()[c] : a(b).metadata() }, staticRules: function (b) { var c = {}; var d = a.data(b.form, "validator"); if (d.settings.rules) { c = a.validator.normalizeRule(d.settings.rules[b.name]) || {} } return c }, normalizeRules: function (b, c) { a.each(b, function (d, e) { if (e === false) { delete b[d]; return } if (e.param || e.depends) { var f = true; switch (typeof e.depends) { case "string": f = !!a(e.depends, c.form).length; break; case "function": f = e.depends.call(c, c); break } if (f) { b[d] = e.param !== undefined ? e.param : true } else { delete b[d] } } }); a.each(b, function (d, e) { b[d] = a.isFunction(e) ? e(c) : e }); a.each(["minlength", "maxlength", "min", "max"], function () { if (b[this]) { b[this] = Number(b[this]) } }); a.each(["rangelength", "range"], function () { if (b[this]) { b[this] = [Number(b[this][0]), Number(b[this][1])] } }); if (a.validator.autoCreateRanges) { if (b.min && b.max) { b.range = [b.min, b.max]; delete b.min; delete b.max } if (b.minlength && b.maxlength) { b.rangelength = [b.minlength, b.maxlength]; delete b.minlength; delete b.maxlength } } if (b.messages) { delete b.messages } return b }, normalizeRule: function (b) { if (typeof b == "string") { var c = {}; a.each(b.split(/\s/), function () { c[this] = true }); b = c } return b }, addMethod: function (b, c, d) { a.validator.methods[b] = c; a.validator.messages[b] = d != undefined ? d : a.validator.messages[b]; if (c.length < 3) { a.validator.addClassRules(b, a.validator.normalizeRule(b)) } }, methods: { required: function (b, c, d) { if (!this.depend(d, c)) return "dependency-mismatch"; switch (c.nodeName.toLowerCase()) { case "select": var e = a(c).val(); return e && e.length > 0; case "input": if (this.checkable(c)) return this.getLength(b, c) > 0; default: return a.trim(b).length > 0 } }, remote: function (b, c, d) { if (this.optional(c)) return "dependency-mismatch"; var e = this.previousValue(c); if (!this.settings.messages[c.name]) this.settings.messages[c.name] = {}; e.originalMessage = this.settings.messages[c.name].remote; this.settings.messages[c.name].remote = e.message; d = typeof d == "string" && { url: d} || d; if (e.old !== b) { e.old = b; var f = this; this.startRequest(c); var g = {}; g[c.name] = b; a.ajax(a.extend(true, { url: d, mode: "abort", port: "validate" + c.name, dataType: "json", data: g, success: function (d) { f.settings.messages[c.name].remote = e.originalMessage; var g = d === true; if (g) { var h = f.formSubmitted; f.prepareElement(c); f.formSubmitted = h; f.successList.push(c); f.showErrors() } else { var i = {}; var j = e.message = d || f.defaultMessage(c, "remote"); i[c.name] = a.isFunction(j) ? j(b) : j; f.showErrors(i) } e.valid = g; f.stopRequest(c, g) } }, d)); return "pending" } else if (this.pending[c.name]) { return "pending" } return e.valid }, minlength: function (b, c, d) { return this.optional(c) || this.getLength(a.trim(b), c) >= d }, maxlength: function (b, c, d) { return this.optional(c) || this.getLength(a.trim(b), c) <= d }, rangelength: function (b, c, d) { var e = this.getLength(a.trim(b), c); return this.optional(c) || e >= d[0] && e <= d[1] }, min: function (a, b, c) { return this.optional(b) || a >= c }, max: function (a, b, c) { return this.optional(b) || a <= c }, range: function (a, b, c) { return this.optional(b) || a >= c[0] && a <= c[1] }, email: function (a, b) { return this.optional(b) || /^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i.test(a) }, url: function (a, b) { return this.optional(b) || /^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(a) }, date: function (a, b) { return this.optional(b) || !/Invalid|NaN/.test(new Date(a)) }, dateISO: function (a, b) { return this.optional(b) || /^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(a) }, number: function (a, b) { return this.optional(b) || /^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(a) }, digits: function (a, b) { return this.optional(b) || /^\d+$/.test(a) }, creditcard: function (a, b) { if (this.optional(b)) return "dependency-mismatch"; if (/[^0-9-]+/.test(a)) return false; var c = 0, d = 0, e = false; a = a.replace(/\D/g, ""); for (var f = a.length - 1; f >= 0; f--) { var g = a.charAt(f); var d = parseInt(g, 10); if (e) { if ((d *= 2) > 9) d -= 9 } c += d; e = !e } return c % 10 == 0 }, accept: function (a, b, c) { c = typeof c == "string" ? c.replace(/,/g, "|") : "png|jpe?g|gif"; return this.optional(b) || a.match(new RegExp(".(" + c + ")$", "i")) }, equalTo: function (b, c, d) { var e = a(d).unbind(".validate-equalTo").bind("blur.validate-equalTo", function () { a(c).valid() }); return b == e.val() } } }); a.format = a.validator.format })(jQuery); (function (a) { var b = a.ajax; var c = {}; a.ajax = function (d) { d = a.extend(d, a.extend({}, a.ajaxSettings, d)); var e = d.port; if (d.mode == "abort") { if (c[e]) { c[e].abort() } return c[e] = b.apply(this, arguments) } return b.apply(this, arguments) } })(jQuery); (function (a) { if (!jQuery.event.special.focusin && !jQuery.event.special.focusout && document.addEventListener) { a.each({ focus: "focusin", blur: "focusout" }, function (b, c) { function d(b) { b = a.event.fix(b); b.type = c; return a.event.handle.call(this, b) } a.event.special[c] = { setup: function () { this.addEventListener(b, d, true) }, teardown: function () { this.removeEventListener(b, d, true) }, handler: function (b) { arguments[0] = a.event.fix(b); arguments[0].type = c; return a.event.handle.apply(this, arguments) } } }) } a.extend(a.fn, { validateDelegate: function (b, c, d) { return this.bind(c, function (c) { var e = a(c.target); if (e.is(b)) { return d.apply(e, arguments) } }) } }) })(jQuery); (function (a) { function l(b) { var c = a(b), e = c.data(d); if (!e) { e = { options: { errorClass: "input-validation-error", errorElement: "span", errorPlacement: a.proxy(i, b), invalidHandler: a.proxy(j, b), messages: {}, rules: {}, success: a.proxy(k, b) }, attachValidation: function () { c.validate(this.options) }, validate: function () { c.validate(); return c.valid() } }; c.data(d, e) } return e } function k(b) { var c = b.data("unobtrusiveContainer"), d = a.parseJSON(c.attr("data-valmsg-replace")); if (c) { c.addClass("field-validation-valid").removeClass("field-validation-error"); b.removeData("unobtrusiveContainer"); if (d) { c.empty() } } } function j(b, c) { var d = a(this).find("[data-valmsg-summary=true]"), e = d.find("ul"); if (e && e.length && c.errorList.length) { e.empty(); d.addClass("validation-summary-errors").removeClass("validation-summary-valid"); a.each(c.errorList, function () { a("<li />").html(this.message).appendTo(e) }) } } function i(b, c) { var d = a(this).find("[data-valmsg-for='" + c[0].name + "']"), e = a.parseJSON(d.attr("data-valmsg-replace")) !== false; d.removeClass("field-validation-valid").addClass("field-validation-error"); b.data("unobtrusiveContainer", d); if (e) { d.empty(); b.removeClass("input-validation-error").appendTo(d) } else { b.hide() } } function h(a, b) { if (a.indexOf("*.") === 0) { a = a.replace("*.", b) } return a } function g(a) { return a.substr(0, a.lastIndexOf(".") + 1) } function f(a) { return a.replace(/^\s+|\s+$/g, "").split(/\s*,\s*/g) } function e(a, b, c) { a.rules[b] = c; if (a.message) { a.messages[b] = a.message } } var b = a.validator, c, d = "unobtrusiveValidation"; b.unobtrusive = { adapters: [], parseElement: function (b, c) { var d = a(b), e = d.parents("form")[0], f, g, h; if (!e) { return } f = l(e); f.options.rules[b.name] = g = {}; f.options.messages[b.name] = h = {}; a.each(this.adapters, function () { var c = "data-val-" + this.name, f = d.attr(c), i = {}; if (f !== undefined) { c += "-"; a.each(this.params, function () { i[this] = d.attr(c + this) }); this.adapt({ element: b, form: e, message: f, params: i, rules: g, messages: h }) } }); jQuery.extend(g, { __dummy__: true }); if (!c) { f.attachValidation() } }, parse: function (c) { a(c).find(":input[data-val=true]").each(function () { b.unobtrusive.parseElement(this, true) }); a("form").each(function () { var a = l(this); if (a) { a.attachValidation() } }) } }; c = b.unobtrusive.adapters; c.add = function (a, b, c) { if (!c) { c = b; b = [] } this.push({ name: a, params: b, adapt: c }); return this }; c.addBool = function (a, b) { return this.add(a, function (c) { e(c, b || a, true) }) }; c.addMinMax = function (a, b, c, d, f, g) { return this.add(a, [f || "min", g || "max"], function (a) { var f = a.params.min, g = a.params.max; if (f && g) { e(a, d, [f, g]) } else if (f) { e(a, b, f) } else if (g) { e(a, c, g) } }) }; c.addSingleVal = function (a, b, c) { return this.add(a, [b || "val"], function (d) { e(d, c || a, d.params[b]) }) }; b.addMethod("__dummy__", function (a, b, c) { return true }); b.addMethod("regex", function (a, b, c) { var d; if (this.optional(b)) { return true } d = (new RegExp(c)).exec(a); return d && d.index === 0 && d[0].length === a.length }); c.addSingleVal("accept", "exts").addSingleVal("regex", "pattern"); c.addBool("creditcard").addBool("date").addBool("digits").addBool("email").addBool("number").addBool("url"); c.addMinMax("length", "minlength", "maxlength", "rangelength").addMinMax("range", "min", "max", "range"); c.add("equalto", ["other"], function (b) { var c = g(b.element.name), d = b.params.other, f = h(d, c), i = a(b.form).find(":input[name=" + f + "]")[0]; e(b, "equalTo", i) }); c.add("required", function (a) { if (a.element.tagName.toUpperCase() !== "INPUT" || a.element.type.toUpperCase() !== "CHECKBOX") { e(a, "required", true) } }); c.add("remote", ["url", "type", "additionalfields"], function (b) { var c = { url: b.params.url, type: b.params.type || "GET", data: {} }, d = g(b.element.name); a.each(f(b.params.additionalfields || b.element.name), function (e, f) { var g = h(f, d); c.data[g] = function () { return a(b.form).find(":input[name='" + g + "']").val() } }); e(b, "remote", c) }); a(function () { b.unobtrusive.parse(document) }) })(jQuery); jQuery.cookie = function (a, b, c) { if (arguments.length > 1 && String(b) !== "[object Object]") { c = jQuery.extend({}, c); if (b === null || b === undefined) { c.expires = -1 } if (typeof c.expires === "number") { var d = c.expires, e = c.expires = new Date; e.setDate(e.getDate() + d) } b = String(b); return document.cookie = [encodeURIComponent(a), "=", c.raw ? b : encodeURIComponent(b), c.expires ? "; expires=" + c.expires.toUTCString() : "", c.path ? "; path=" + c.path : "", c.domain ? "; domain=" + c.domain : "", c.secure ? "; secure" : ""].join("") } c = b || {}; var f, g = c.raw ? function (a) { return a } : decodeURIComponent; return (f = (new RegExp("(?:^|; )" + encodeURIComponent(a) + "=([^;]*)")).exec(document.cookie)) ? g(f[1]) : null }; new function (a) { var b = a.separator || "&"; var c = a.spaces === false ? false : true; var d = a.suffix === false ? "" : "[]"; var e = a.prefix === false ? false : true; var f = e ? a.hash === true ? "#" : "?" : ""; var g = a.numbers === false ? false : true; jQuery.query = new function () { var a = function (a, b) { return a != undefined && a !== null && (!!b ? a.constructor == b : true) }; var d = function (a) { var b, c = /\[([^[]*)\]/g, d = /^([^[]+)(\[.*\])?$/.exec(a), e = d[1], f = []; while (b = c.exec(d[2])) f.push(b[1]); return [e, f] }; var e = function (b, c, d) { var f, g = c.shift(); if (typeof b != "object") b = null; if (g === "") { if (!b) b = []; if (a(b, Array)) { b.push(c.length == 0 ? d : e(null, c.slice(0), d)) } else if (a(b, Object)) { var h = 0; while (b[h++] != null); b[--h] = c.length == 0 ? d : e(b[h], c.slice(0), d) } else { b = []; b.push(c.length == 0 ? d : e(null, c.slice(0), d)) } } else if (g && g.match(/^\s*[0-9]+\s*$/)) { var i = parseInt(g, 10); if (!b) b = []; b[i] = c.length == 0 ? d : e(b[i], c.slice(0), d) } else if (g) { var i = g.replace(/^\s*|\s*$/g, ""); if (!b) b = {}; if (a(b, Array)) { var j = {}; for (var h = 0; h < b.length; ++h) { j[h] = b[h] } b = j } b[i] = c.length == 0 ? d : e(b[i], c.slice(0), d) } else { return d } return b }; var h = function (a) { var b = this; b.keys = {}; if (a.queryObject) { jQuery.each(a.get(), function (a, c) { b.SET(a, c) }) } else { jQuery.each(arguments, function () { var a = "" + this; a = a.replace(/^[?#]/, ""); a = a.replace(/[;&]$/, ""); if (c) a = a.replace(/[+]/g, " "); jQuery.each(a.split(/[&;]/), function () { var a = decodeURIComponent(this.split("=")[0] || ""); var c = decodeURIComponent(this.split("=")[1] || ""); if (!a) return; if (g) { if (/^[+-]?[0-9]+\.[0-9]*$/.test(c)) c = parseFloat(c); else if (/^[+-]?[0-9]+$/.test(c)) c = parseInt(c, 10) } c = !c && c !== 0 ? true : c; if (c !== false && c !== true && typeof c != "number") c = c; b.SET(a, c) }) }) } return b }; h.prototype = { queryObject: true, has: function (b, c) { var d = this.get(b); return a(d, c) }, GET: function (b) { if (!a(b)) return this.keys; var c = d(b), e = c[0], f = c[1]; var g = this.keys[e]; while (g != null && f.length != 0) { g = g[f.shift()] } return typeof g == "number" ? g : g || "" }, get: function (b) { var c = this.GET(b); if (a(c, Object)) return jQuery.extend(true, {}, c); else if (a(c, Array)) return c.slice(0); return c }, SET: function (b, c) { var f = !a(c) ? null : c; var g = d(b), h = g[0], i = g[1]; var j = this.keys[h]; this.keys[h] = e(j, i.slice(0), f); return this }, set: function (a, b) { return this.copy().SET(a, b) }, REMOVE: function (a) { return this.SET(a, null).COMPACT() }, remove: function (a) { return this.copy().REMOVE(a) }, EMPTY: function () { var a = this; jQuery.each(a.keys, function (b, c) { delete a.keys[b] }); return a }, load: function (a) { var b = a.replace(/^.*?[#](.+?)(?:\?.+)?$/, "$1"); var c = a.replace(/^.*?[?](.+?)(?:#.+)?$/, "$1"); return new h(a.length == c.length ? "" : c, a.length == b.length ? "" : b) }, empty: function () { return this.copy().EMPTY() }, copy: function () { return new h(this) }, COMPACT: function () { function b(c) { var d = typeof c == "object" ? a(c, Array) ? [] : {} : c; if (typeof c == "object") { function e(b, c, d) { if (a(b, Array)) b.push(d); else b[c] = d } jQuery.each(c, function (c, f) { if (!a(f)) return true; e(d, c, b(f)) }) } return d } this.keys = b(this.keys); return this }, compact: function () { return this.copy().COMPACT() }, toString: function () { var d = 0, e = [], g = [], h = this; var i = function (a) { a = a + ""; if (c) a = a.replace(/ /g, "+"); return encodeURIComponent(a) }; var j = function (b, c, d) { if (!a(d) || d === false) return; var e = [i(c)]; if (d !== true) { e.push("="); e.push(i(d)) } b.push(e.join("")) }; var k = function (a, b) { var c = function (a) { return !b || b == "" ? [a].join("") : [b, "[", a, "]"].join("") }; jQuery.each(a, function (a, b) { if (typeof b == "object") k(b, c(a)); else j(g, c(a), b) }) }; k(this.keys); if (g.length > 0) e.push(f); e.push(g.join(b)); return e.join("") } }; return new h(location.search, location.hash) } } (jQuery.query || {})